2025-10-21 15:48:20,377 - root - INFO - Starting Device Service...
2025-10-21 15:48:20,378 - root - INFO - Configuration loaded: HOST=0.0.0.0, PORT=5200
2025-10-21 15:48:20,378 - root - INFO - 啟動MQTT客戶端，連接到 127.0.0.1:2834
2025-10-21 15:48:20,379 - app.mqtt.client - INFO - [MQTT_CLIENT] 開始連接MQTT Broker - 主機: 127.0.0.1:2834, 客戶端ID: device_service_1761032900379_35940
2025-10-21 15:48:20,380 - app.mqtt.client - INFO - [MQTT_CLIENT] 連接MQTT Broker: 127.0.0.1:2834
2025-10-21 15:48:20,383 - app.mqtt.client - INFO - [MQTT_CLIENT] MQTT網路循環已啟動
2025-10-21 15:48:20,387 - app.mqtt.client - INFO - [MQTT_CLIENT] MQTT客戶端連接成功 - 錯誤碼: 0
2025-10-21 15:48:20,900 - app.mqtt.client - INFO - [MQTT_CLIENT] MQTT客戶端連接建立成功 - 重試次數: 1
2025-10-21 15:48:20,900 - root - INFO - MQTT客戶端連接成功
2025-10-21 15:48:20,901 - app.mqtt.client - INFO - [MQTT_CLIENT] 註冊訊息處理器 - Topic: mcs/events/ProxyService/status/+
2025-10-21 15:48:20,901 - app.mqtt.client - INFO - [MQTT_CLIENT] 訂閱主題 - Topic: mcs/events/ProxyService/status/+
2025-10-21 15:48:20,902 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功訂閱主題 - Topic: mcs/events/ProxyService/status/+, 結果碼: 0
2025-10-21 15:48:20,903 - app.mqtt.client - INFO - [MQTT_CLIENT] 註冊訊息處理器 - Topic: mcs/events/DeviceService/status/+
2025-10-21 15:48:20,903 - app.mqtt.client - INFO - [MQTT_CLIENT] 訂閱主題 - Topic: mcs/events/DeviceService/status/+
2025-10-21 15:48:20,903 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功訂閱主題 - Topic: mcs/events/DeviceService/status/+, 結果碼: 0
2025-10-21 15:48:20,904 - app.mqtt.client - INFO - [MQTT_CLIENT] 註冊訊息處理器 - Topic: mcs/events/deviceService/+
2025-10-21 15:48:20,904 - app.mqtt.client - INFO - [MQTT_CLIENT] 訂閱主題 - Topic: mcs/events/deviceService/+
2025-10-21 15:48:20,904 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功訂閱主題 - Topic: mcs/events/deviceService/+, 結果碼: 0
2025-10-21 15:48:20,905 - root - INFO - MQTT訊息監聽已啟動
2025-10-21 15:48:20,909 - root - INFO - Database tables created successfully
2025-10-21 15:48:20,911 - app.services.background_worker - INFO - Background worker started
2025-10-21 15:48:20,911 - root - INFO - Background worker started
2025-10-21 15:48:20,911 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 15:48:20,912 - app.services.background_worker - INFO - [CACHE_LOAD] Loading devices to cache for the first time
2025-10-21 15:48:20,919 - app.services.device_processor - INFO - [CACHE_LOAD] Starting device cache load
2025-10-21 15:48:20,919 - app.services.device_processor - INFO - [CACHE_LOAD] Cache load completed: 5 devices loaded
2025-10-21 15:49:08,086 - app.services.device_processor - INFO - [CACHE_LOAD] Device status cache now contains 3 entries
2025-10-21 15:49:08,087 - app.services.background_worker - INFO - [CACHE_LOAD] Loaded 5 devices to cache (one-time initialization)
2025-10-21 15:49:08,088 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 15:50:51,474 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 15:50:51,475 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 15:50:51,475 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 15:51:51,186 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 15:51:51,187 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 15:51:51,476 - app.services.background_worker - INFO - Background worker task cancelled
2025-10-21 15:51:58,019 - root - INFO - Starting Device Service...
2025-10-21 15:51:58,019 - root - INFO - Configuration loaded: HOST=0.0.0.0, PORT=5200
2025-10-21 15:51:58,020 - root - INFO - 啟動MQTT客戶端，連接到 127.0.0.1:2834
2025-10-21 15:51:58,020 - app.mqtt.client - INFO - [MQTT_CLIENT] 開始連接MQTT Broker - 主機: 127.0.0.1:2834, 客戶端ID: device_service_1761033118020_37796
2025-10-21 15:51:58,021 - app.mqtt.client - INFO - [MQTT_CLIENT] 連接MQTT Broker: 127.0.0.1:2834
2025-10-21 15:51:58,036 - app.mqtt.client - INFO - [MQTT_CLIENT] MQTT網路循環已啟動
2025-10-21 15:51:58,037 - app.mqtt.client - INFO - [MQTT_CLIENT] MQTT客戶端連接成功 - 錯誤碼: 0
2025-10-21 15:51:58,545 - app.mqtt.client - INFO - [MQTT_CLIENT] MQTT客戶端連接建立成功 - 重試次數: 1
2025-10-21 15:51:58,545 - root - INFO - MQTT客戶端連接成功
2025-10-21 15:51:58,546 - app.mqtt.client - INFO - [MQTT_CLIENT] 註冊訊息處理器 - Topic: mcs/events/ProxyService/status/+
2025-10-21 15:51:58,547 - app.mqtt.client - INFO - [MQTT_CLIENT] 訂閱主題 - Topic: mcs/events/ProxyService/status/+
2025-10-21 15:51:58,548 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功訂閱主題 - Topic: mcs/events/ProxyService/status/+, 結果碼: 0
2025-10-21 15:51:58,548 - app.mqtt.client - INFO - [MQTT_CLIENT] 註冊訊息處理器 - Topic: mcs/events/DeviceService/status/+
2025-10-21 15:51:58,549 - app.mqtt.client - INFO - [MQTT_CLIENT] 訂閱主題 - Topic: mcs/events/DeviceService/status/+
2025-10-21 15:51:58,550 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功訂閱主題 - Topic: mcs/events/DeviceService/status/+, 結果碼: 0
2025-10-21 15:51:58,550 - app.mqtt.client - INFO - [MQTT_CLIENT] 註冊訊息處理器 - Topic: mcs/events/deviceService/+
2025-10-21 15:51:58,551 - app.mqtt.client - INFO - [MQTT_CLIENT] 訂閱主題 - Topic: mcs/events/deviceService/+
2025-10-21 15:51:58,552 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功訂閱主題 - Topic: mcs/events/deviceService/+, 結果碼: 0
2025-10-21 15:51:58,552 - root - INFO - MQTT訊息監聽已啟動
2025-10-21 15:51:58,556 - root - INFO - Database tables created successfully
2025-10-21 15:51:58,558 - app.services.background_worker - INFO - Background worker started
2025-10-21 15:51:58,558 - root - INFO - Background worker started
2025-10-21 15:51:58,558 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 15:51:58,559 - app.services.background_worker - INFO - [CACHE_LOAD] Loading devices to cache for the first time
2025-10-21 15:51:58,566 - app.services.device_processor - INFO - [CACHE_LOAD] Starting device cache load
2025-10-21 15:51:58,567 - app.services.device_processor - INFO - [CACHE_LOAD] Cache load completed: 5 devices loaded
2025-10-21 15:51:58,567 - app.services.device_processor - INFO - [CACHE_LOAD] Device status cache now contains 3 entries
2025-10-21 15:51:58,567 - app.services.background_worker - INFO - [CACHE_LOAD] Loaded 5 devices to cache (one-time initialization)
2025-10-21 15:51:58,568 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 15:52:04,320 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 15:52:04,322 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 15:52:04,322 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 15:52:06,142 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 15:52:06,144 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 15:52:06,362 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5555/Health "HTTP/1.1 200 OK"
2025-10-21 15:52:06,365 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:52:06,366 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 55, calling start API
2025-10-21 15:52:06,380 - app.services.device_processor - INFO - Sending start data for proxy 55: {'proxyid': '55', 'Controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:52:06,571 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5555/start "HTTP/1.1 200 OK"
2025-10-21 15:52:06,571 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:52:06,572 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 55: proxyServiceStart changed to '1'
2025-10-21 15:52:06,573 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 55: {'proxyid': 55, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}}
2025-10-21 15:52:06,573 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:52:06,574 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:52:06,580 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:52:06,581 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:52:06,582 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 55: network OK
2025-10-21 15:52:06,583 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:52:06,584 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 55 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:52:06,584 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 55: healthy=True, response_time=0.0
2025-10-21 15:52:06,585 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:52:06,586 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:52:06,587 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:52:06,588 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:52:06,588 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:52:06,588 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 56 (enabled: 1) ==========
2025-10-21 15:52:06,589 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 56 current status: OK
2025-10-21 15:52:06,590 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 56 <<<<<
2025-10-21 15:52:06,590 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 56 (IP: 127.0.0.1:5556)
2025-10-21 15:52:06,611 - app.services.device_processor - INFO - Checking health for proxy 56 at http://127.0.0.1:5556/Health
2025-10-21 15:52:06,814 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5556/Health "HTTP/1.1 200 OK"
2025-10-21 15:52:06,815 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:52:06,816 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 56, calling start API
2025-10-21 15:52:06,817 - app.services.device_processor - INFO - Sending start data for proxy 56: {'proxyid': '56', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:52:07,009 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5556/start "HTTP/1.1 200 OK"
2025-10-21 15:52:07,011 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:52:07,011 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 56: proxyServiceStart changed to '1'
2025-10-21 15:52:07,013 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 56: {'proxyid': 56, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}}
2025-10-21 15:52:07,013 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:52:07,014 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:52:07,015 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:52:07,016 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:52:07,017 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 56: network OK
2025-10-21 15:52:07,017 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:52:07,018 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 56 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:52:07,018 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 56: healthy=True, response_time=0.0
2025-10-21 15:52:07,018 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:52:07,019 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:52:07,020 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:52:07,021 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:52:07,022 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:52:07,022 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 57 (enabled: 1) ==========
2025-10-21 15:52:07,022 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 57 current status: OK
2025-10-21 15:52:07,023 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 57 <<<<<
2025-10-21 15:52:07,023 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 57 (IP: 127.0.0.1:5557)
2025-10-21 15:52:07,024 - app.services.device_processor - INFO - Checking health for proxy 57 at http://127.0.0.1:5557/Health
2025-10-21 15:52:07,217 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5557/Health "HTTP/1.1 200 OK"
2025-10-21 15:52:07,218 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:52:07,220 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 57, calling start API
2025-10-21 15:52:07,221 - app.services.device_processor - INFO - Sending start data for proxy 57: {'proxyid': '57', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:52:07,412 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5557/start "HTTP/1.1 200 OK"
2025-10-21 15:52:07,413 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:52:07,413 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 57: proxyServiceStart changed to '1'
2025-10-21 15:52:07,414 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 57: {'proxyid': 57, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}}
2025-10-21 15:52:07,414 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:52:07,415 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:52:07,416 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:52:07,417 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:52:07,417 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 57: network OK
2025-10-21 15:52:07,417 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:52:07,418 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 57 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:52:07,418 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 57: healthy=True, response_time=0.0
2025-10-21 15:52:07,419 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:52:07,420 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:52:07,421 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:52:07,422 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:52:07,422 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:52:07,423 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 60 (enabled: 0) ==========
2025-10-21 15:52:07,423 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 60
2025-10-21 15:52:07,423 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 61 (enabled: 0) ==========
2025-10-21 15:52:07,424 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 61
2025-10-21 15:52:07,424 - app.services.background_worker - INFO - [HEALTH_SYNC] Completed health check for 5 devices
2025-10-21 15:52:07,424 - app.services.background_worker - INFO - [BG_WORKER] Background task execution cycle completed
2025-10-21 15:52:07,624 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 15:52:07,625 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 15:52:07,626 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 15:52:07,627 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 15:52:07,627 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 15:52:07,627 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 15:52:07,628 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 15:52:07,833 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5555/Health "HTTP/1.1 200 OK"
2025-10-21 15:52:07,834 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:52:07,834 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 55, calling start API
2025-10-21 15:52:07,835 - app.services.device_processor - INFO - Sending start data for proxy 55: {'proxyid': '55', 'Controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:52:08,049 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5555/start "HTTP/1.1 200 OK"
2025-10-21 15:52:08,050 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:52:08,051 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 55: proxyServiceStart changed to '1'
2025-10-21 15:52:08,051 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 55: {'proxyid': 55, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}}
2025-10-21 15:52:08,051 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:52:08,053 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:52:08,054 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:52:08,055 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:52:08,056 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 55: network OK
2025-10-21 15:52:08,056 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:52:08,057 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 55 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:52:08,057 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 55: healthy=True, response_time=0.0
2025-10-21 15:52:08,057 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:52:08,059 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:52:08,060 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:52:08,060 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:52:08,061 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:52:08,061 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 56 (enabled: 1) ==========
2025-10-21 15:52:08,061 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 56 current status: OK
2025-10-21 15:52:08,062 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 56 <<<<<
2025-10-21 15:52:08,062 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 56 (IP: 127.0.0.1:5556)
2025-10-21 15:52:08,063 - app.services.device_processor - INFO - Checking health for proxy 56 at http://127.0.0.1:5556/Health
2025-10-21 15:52:08,284 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5556/Health "HTTP/1.1 200 OK"
2025-10-21 15:52:08,285 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:52:08,286 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 56, calling start API
2025-10-21 15:52:08,303 - app.services.device_processor - INFO - Sending start data for proxy 56: {'proxyid': '56', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:52:08,504 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5556/start "HTTP/1.1 200 OK"
2025-10-21 15:52:08,505 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:52:08,506 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 56: proxyServiceStart changed to '1'
2025-10-21 15:52:08,507 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 56: {'proxyid': 56, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}}
2025-10-21 15:52:08,507 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:52:08,508 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:52:08,509 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:52:08,510 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:52:08,510 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 56: network OK
2025-10-21 15:52:08,511 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:52:08,511 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 56 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:52:08,512 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 56: healthy=True, response_time=0.0
2025-10-21 15:52:08,512 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:52:08,514 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:52:08,515 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:52:08,515 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:52:08,516 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:52:08,516 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 57 (enabled: 1) ==========
2025-10-21 15:52:08,517 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 57 current status: OK
2025-10-21 15:52:08,517 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 57 <<<<<
2025-10-21 15:52:08,518 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 57 (IP: 127.0.0.1:5557)
2025-10-21 15:52:08,519 - app.services.device_processor - INFO - Checking health for proxy 57 at http://127.0.0.1:5557/Health
2025-10-21 15:52:08,709 - root - INFO - Shutting down Device Service...
2025-10-21 15:52:08,710 - app.services.background_worker - INFO - Background worker stopped
2025-10-21 15:52:08,710 - app.mqtt.client - INFO - [MQTT_CLIENT] 開始斷開MQTT連接 - 客戶端ID: b'device_service_1761033118021_37796'
2025-10-21 15:52:09,518 - app.mqtt.client - WARNING - [MQTT_CLIENT] MQTT客戶端斷開連接 - 錯誤碼: 0, 客戶端ID: b'device_service_1761033118021_37796'
2025-10-21 15:52:09,519 - app.mqtt.client - INFO - [MQTT_CLIENT] MQTT客戶端已斷開連接
2025-10-21 15:52:09,519 - root - INFO - MQTT客戶端已關閉
2025-10-21 15:52:09,520 - root - INFO - Device Service shutdown complete
2025-10-21 15:52:09,523 - app.services.background_worker - INFO - Background worker task cancelled
2025-10-21 15:53:18,918 - root - INFO - Starting Device Service...
2025-10-21 15:53:18,919 - root - INFO - Configuration loaded: HOST=0.0.0.0, PORT=5200
2025-10-21 15:53:18,919 - root - INFO - 啟動MQTT客戶端，連接到 127.0.0.1:2834
2025-10-21 15:53:18,920 - app.mqtt.client - INFO - [MQTT_CLIENT] 開始連接MQTT Broker - 主機: 127.0.0.1:2834, 客戶端ID: device_service_1761033198920_28456
2025-10-21 15:53:18,921 - app.mqtt.client - INFO - [MQTT_CLIENT] 連接MQTT Broker: 127.0.0.1:2834
2025-10-21 15:53:18,941 - app.mqtt.client - INFO - [MQTT_CLIENT] MQTT網路循環已啟動
2025-10-21 15:53:18,943 - app.mqtt.client - INFO - [MQTT_CLIENT] MQTT客戶端連接成功 - 錯誤碼: 0
2025-10-21 15:53:19,450 - app.mqtt.client - INFO - [MQTT_CLIENT] MQTT客戶端連接建立成功 - 重試次數: 1
2025-10-21 15:53:19,451 - root - INFO - MQTT客戶端連接成功
2025-10-21 15:53:19,452 - app.mqtt.client - INFO - [MQTT_CLIENT] 註冊訊息處理器 - Topic: mcs/events/ProxyService/status/+
2025-10-21 15:53:19,452 - app.mqtt.client - INFO - [MQTT_CLIENT] 訂閱主題 - Topic: mcs/events/ProxyService/status/+
2025-10-21 15:53:19,453 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功訂閱主題 - Topic: mcs/events/ProxyService/status/+, 結果碼: 0
2025-10-21 15:53:19,453 - app.mqtt.client - INFO - [MQTT_CLIENT] 註冊訊息處理器 - Topic: mcs/events/DeviceService/status/+
2025-10-21 15:53:19,454 - app.mqtt.client - INFO - [MQTT_CLIENT] 訂閱主題 - Topic: mcs/events/DeviceService/status/+
2025-10-21 15:53:19,454 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功訂閱主題 - Topic: mcs/events/DeviceService/status/+, 結果碼: 0
2025-10-21 15:53:19,455 - app.mqtt.client - INFO - [MQTT_CLIENT] 註冊訊息處理器 - Topic: mcs/events/deviceService/+
2025-10-21 15:53:19,455 - app.mqtt.client - INFO - [MQTT_CLIENT] 訂閱主題 - Topic: mcs/events/deviceService/+
2025-10-21 15:53:19,456 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功訂閱主題 - Topic: mcs/events/deviceService/+, 結果碼: 0
2025-10-21 15:53:19,457 - root - INFO - MQTT訊息監聽已啟動
2025-10-21 15:53:19,460 - root - INFO - Database tables created successfully
2025-10-21 15:53:19,462 - app.services.background_worker - INFO - Background worker started
2025-10-21 15:53:19,463 - root - INFO - Background worker started
2025-10-21 15:53:19,463 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 15:53:19,464 - app.services.background_worker - INFO - [CACHE_LOAD] Loading devices to cache for the first time
2025-10-21 15:53:19,471 - app.services.device_processor - INFO - [CACHE_LOAD] Starting device cache load
2025-10-21 15:53:19,472 - app.services.device_processor - INFO - [CACHE_LOAD] Cache load completed: 5 devices loaded
2025-10-21 15:53:19,473 - app.services.device_processor - INFO - [CACHE_LOAD] Device status cache now contains 3 entries
2025-10-21 15:53:19,473 - app.services.background_worker - INFO - [CACHE_LOAD] Loaded 5 devices to cache (one-time initialization)
2025-10-21 15:53:19,474 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 15:53:19,474 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 15:53:19,475 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 15:53:19,475 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 15:53:19,476 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 15:53:19,477 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 15:53:19,706 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5555/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:19,709 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:19,709 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 55, calling start API
2025-10-21 15:53:19,730 - app.services.device_processor - INFO - Sending start data for proxy 55: {'proxyid': '55', 'Controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:19,921 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5555/start "HTTP/1.1 200 OK"
2025-10-21 15:53:19,923 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:19,923 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 55: proxyServiceStart changed to '1'
2025-10-21 15:53:19,924 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 55: {'proxyid': 55, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}}
2025-10-21 15:53:19,924 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:19,925 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:53:19,927 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:53:19,928 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:53:19,928 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 55: network OK
2025-10-21 15:53:19,928 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:53:19,929 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 55 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:19,930 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 55: healthy=True, response_time=0.0
2025-10-21 15:53:19,931 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:19,932 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:53:19,933 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:53:19,934 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:53:19,934 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:53:19,935 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 56 (enabled: 1) ==========
2025-10-21 15:53:19,935 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 56 current status: OK
2025-10-21 15:53:19,936 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 56 <<<<<
2025-10-21 15:53:19,936 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 56 (IP: 127.0.0.1:5556)
2025-10-21 15:53:19,938 - app.services.device_processor - INFO - Checking health for proxy 56 at http://127.0.0.1:5556/Health
2025-10-21 15:53:20,154 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5556/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:20,156 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:20,156 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 56, calling start API
2025-10-21 15:53:20,157 - app.services.device_processor - INFO - Sending start data for proxy 56: {'proxyid': '56', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:20,374 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5556/start "HTTP/1.1 200 OK"
2025-10-21 15:53:20,375 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:20,375 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 56: proxyServiceStart changed to '1'
2025-10-21 15:53:20,376 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 56: {'proxyid': 56, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}}
2025-10-21 15:53:20,376 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:20,377 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:53:20,379 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:53:20,380 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:53:20,381 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 56: network OK
2025-10-21 15:53:20,382 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:53:20,382 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 56 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:20,383 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 56: healthy=True, response_time=0.0
2025-10-21 15:53:20,383 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:20,385 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:53:20,386 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:53:20,387 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:53:20,388 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:53:20,388 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 57 (enabled: 1) ==========
2025-10-21 15:53:20,389 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 57 current status: OK
2025-10-21 15:53:20,389 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 57 <<<<<
2025-10-21 15:53:20,390 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 57 (IP: 127.0.0.1:5557)
2025-10-21 15:53:20,390 - app.services.device_processor - INFO - Checking health for proxy 57 at http://127.0.0.1:5557/Health
2025-10-21 15:53:20,615 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5557/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:20,617 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:20,617 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 57, calling start API
2025-10-21 15:53:20,619 - app.services.device_processor - INFO - Sending start data for proxy 57: {'proxyid': '57', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:20,846 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5557/start "HTTP/1.1 200 OK"
2025-10-21 15:53:20,848 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:20,848 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 57: proxyServiceStart changed to '1'
2025-10-21 15:53:20,849 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 57: {'proxyid': 57, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}}
2025-10-21 15:53:20,850 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:20,851 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:53:20,853 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:53:20,854 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:53:20,855 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:53:20,855 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 57: network OK
2025-10-21 15:53:20,856 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 57 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:20,856 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 57: healthy=True, response_time=0.0
2025-10-21 15:53:20,857 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:20,858 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:53:20,859 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:53:20,860 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:53:20,861 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:53:20,861 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 60 (enabled: 0) ==========
2025-10-21 15:53:20,862 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 60
2025-10-21 15:53:20,863 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 61 (enabled: 0) ==========
2025-10-21 15:53:20,863 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 61
2025-10-21 15:53:20,863 - app.services.background_worker - INFO - [HEALTH_SYNC] Completed health check for 5 devices
2025-10-21 15:53:20,864 - app.services.background_worker - INFO - [BG_WORKER] Background task execution cycle completed
2025-10-21 15:53:21,068 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 15:53:21,069 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 15:53:21,070 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 15:53:21,070 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 15:53:21,071 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 15:53:21,071 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 15:53:21,084 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 15:53:21,293 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5555/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:21,294 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:21,295 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 55, calling start API
2025-10-21 15:53:21,296 - app.services.device_processor - INFO - Sending start data for proxy 55: {'proxyid': '55', 'Controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:21,525 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5555/start "HTTP/1.1 200 OK"
2025-10-21 15:53:21,526 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:21,527 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 55: proxyServiceStart changed to '1'
2025-10-21 15:53:21,528 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 55: {'proxyid': 55, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}}
2025-10-21 15:53:21,528 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:21,529 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:53:21,530 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:53:21,531 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:53:21,532 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:53:21,532 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 55: network OK
2025-10-21 15:53:21,533 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 55 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:21,534 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 55: healthy=True, response_time=0.0
2025-10-21 15:53:21,535 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:21,536 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:53:21,538 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:53:21,538 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:53:21,539 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:53:21,539 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 56 (enabled: 1) ==========
2025-10-21 15:53:21,540 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 56 current status: OK
2025-10-21 15:53:21,540 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 56 <<<<<
2025-10-21 15:53:21,541 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 56 (IP: 127.0.0.1:5556)
2025-10-21 15:53:21,567 - app.services.device_processor - INFO - Checking health for proxy 56 at http://127.0.0.1:5556/Health
2025-10-21 15:53:21,795 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5556/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:21,797 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:21,797 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 56, calling start API
2025-10-21 15:53:21,798 - app.services.device_processor - INFO - Sending start data for proxy 56: {'proxyid': '56', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:22,020 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5556/start "HTTP/1.1 200 OK"
2025-10-21 15:53:22,021 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:22,023 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 56: proxyServiceStart changed to '1'
2025-10-21 15:53:22,024 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 56: {'proxyid': 56, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}}
2025-10-21 15:53:22,024 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:22,026 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:53:22,027 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:53:22,028 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:53:22,029 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:53:22,029 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 56: network OK
2025-10-21 15:53:22,030 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 56 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:22,031 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 56: healthy=True, response_time=0.0
2025-10-21 15:53:22,031 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:22,033 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:53:22,034 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:53:22,035 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:53:22,036 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:53:22,036 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 57 (enabled: 1) ==========
2025-10-21 15:53:22,037 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 57 current status: OK
2025-10-21 15:53:22,037 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 57 <<<<<
2025-10-21 15:53:22,038 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 57 (IP: 127.0.0.1:5557)
2025-10-21 15:53:22,039 - app.services.device_processor - INFO - Checking health for proxy 57 at http://127.0.0.1:5557/Health
2025-10-21 15:53:22,245 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5557/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:22,246 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:22,246 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 57, calling start API
2025-10-21 15:53:22,265 - app.services.device_processor - INFO - Sending start data for proxy 57: {'proxyid': '57', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:22,490 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5557/start "HTTP/1.1 200 OK"
2025-10-21 15:53:22,492 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:22,492 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 57: proxyServiceStart changed to '1'
2025-10-21 15:53:22,493 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 57: {'proxyid': 57, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}}
2025-10-21 15:53:22,493 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:22,495 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:53:22,495 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:53:22,497 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:53:22,497 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:53:22,498 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 57: network OK
2025-10-21 15:53:22,499 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 57 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:22,500 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 57: healthy=True, response_time=0.0
2025-10-21 15:53:22,500 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:22,501 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:53:22,503 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:53:22,503 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:53:22,504 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:53:22,504 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 60 (enabled: 0) ==========
2025-10-21 15:53:22,505 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 60
2025-10-21 15:53:22,505 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 61 (enabled: 0) ==========
2025-10-21 15:53:22,506 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 61
2025-10-21 15:53:22,507 - app.services.background_worker - INFO - [HEALTH_SYNC] Completed health check for 5 devices
2025-10-21 15:53:22,507 - app.services.background_worker - INFO - [BG_WORKER] Background task execution cycle completed
2025-10-21 15:53:22,699 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 15:53:22,701 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 15:53:22,701 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 15:53:22,701 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 15:53:22,702 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 15:53:22,702 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 15:53:22,703 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 15:53:22,933 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5555/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:22,934 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:22,934 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 55, calling start API
2025-10-21 15:53:22,936 - app.services.device_processor - INFO - Sending start data for proxy 55: {'proxyid': '55', 'Controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:23,187 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5555/start "HTTP/1.1 200 OK"
2025-10-21 15:53:23,188 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:23,189 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 55: proxyServiceStart changed to '1'
2025-10-21 15:53:23,190 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 55: {'proxyid': 55, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}}
2025-10-21 15:53:23,190 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:23,192 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:53:23,193 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:53:23,194 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:53:23,195 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:53:23,195 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 55: network OK
2025-10-21 15:53:23,197 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 55 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:23,197 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 55: healthy=True, response_time=0.0
2025-10-21 15:53:23,198 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:23,200 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:53:23,201 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:53:23,202 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:53:23,203 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:53:23,203 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 56 (enabled: 1) ==========
2025-10-21 15:53:23,204 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 56 current status: OK
2025-10-21 15:53:23,205 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 56 <<<<<
2025-10-21 15:53:23,206 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 56 (IP: 127.0.0.1:5556)
2025-10-21 15:53:23,207 - app.services.device_processor - INFO - Checking health for proxy 56 at http://127.0.0.1:5556/Health
2025-10-21 15:53:23,474 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5556/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:23,476 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:23,477 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 56, calling start API
2025-10-21 15:53:23,478 - app.services.device_processor - INFO - Sending start data for proxy 56: {'proxyid': '56', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:23,738 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5556/start "HTTP/1.1 200 OK"
2025-10-21 15:53:23,739 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:23,740 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 56: proxyServiceStart changed to '1'
2025-10-21 15:53:23,741 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 56: {'proxyid': 56, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}}
2025-10-21 15:53:23,742 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:23,743 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:53:23,745 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:53:23,746 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:53:23,746 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:53:23,747 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 56: network OK
2025-10-21 15:53:23,749 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 56 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:23,749 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 56: healthy=True, response_time=0.0
2025-10-21 15:53:23,750 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:23,752 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:53:23,753 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:53:23,755 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:53:23,755 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:53:23,756 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 57 (enabled: 1) ==========
2025-10-21 15:53:23,757 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 57 current status: OK
2025-10-21 15:53:23,757 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 57 <<<<<
2025-10-21 15:53:23,758 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 57 (IP: 127.0.0.1:5557)
2025-10-21 15:53:23,759 - app.services.device_processor - INFO - Checking health for proxy 57 at http://127.0.0.1:5557/Health
2025-10-21 15:53:24,030 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5557/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:24,032 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:24,032 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 57, calling start API
2025-10-21 15:53:24,034 - app.services.device_processor - INFO - Sending start data for proxy 57: {'proxyid': '57', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:24,316 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5557/start "HTTP/1.1 200 OK"
2025-10-21 15:53:24,318 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:24,319 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 57: proxyServiceStart changed to '1'
2025-10-21 15:53:24,320 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 57: {'proxyid': 57, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}}
2025-10-21 15:53:24,321 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:24,322 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:53:24,324 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:53:24,324 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:53:24,325 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:53:24,325 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 57: network OK
2025-10-21 15:53:24,327 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 57 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:24,327 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 57: healthy=True, response_time=0.0
2025-10-21 15:53:24,328 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:24,330 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:53:24,331 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:53:24,332 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:53:24,333 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:53:24,334 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 60 (enabled: 0) ==========
2025-10-21 15:53:24,334 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 60
2025-10-21 15:53:24,335 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 61 (enabled: 0) ==========
2025-10-21 15:53:24,335 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 61
2025-10-21 15:53:24,336 - app.services.background_worker - INFO - [HEALTH_SYNC] Completed health check for 5 devices
2025-10-21 15:53:24,337 - app.services.background_worker - INFO - [BG_WORKER] Background task execution cycle completed
2025-10-21 15:53:24,527 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 15:53:24,528 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 15:53:24,529 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 15:53:24,530 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 15:53:24,530 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 15:53:24,531 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 15:53:24,533 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 15:53:24,798 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5555/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:24,799 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:24,800 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 55, calling start API
2025-10-21 15:53:24,801 - app.services.device_processor - INFO - Sending start data for proxy 55: {'proxyid': '55', 'Controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:25,042 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5555/start "HTTP/1.1 200 OK"
2025-10-21 15:53:25,043 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:25,044 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 55: proxyServiceStart changed to '1'
2025-10-21 15:53:25,044 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 55: {'proxyid': 55, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}}
2025-10-21 15:53:25,045 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:25,046 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:53:25,047 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:53:25,049 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:53:25,050 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:53:25,051 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 55: network OK
2025-10-21 15:53:25,052 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 55 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:25,052 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 55: healthy=True, response_time=0.0
2025-10-21 15:53:25,053 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:25,055 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:53:25,057 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:53:25,058 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:53:25,058 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:53:25,059 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 56 (enabled: 1) ==========
2025-10-21 15:53:25,060 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 56 current status: OK
2025-10-21 15:53:25,060 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 56 <<<<<
2025-10-21 15:53:25,061 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 56 (IP: 127.0.0.1:5556)
2025-10-21 15:53:25,087 - app.services.device_processor - INFO - Checking health for proxy 56 at http://127.0.0.1:5556/Health
2025-10-21 15:53:25,377 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5556/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:25,379 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:25,379 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 56, calling start API
2025-10-21 15:53:25,381 - app.services.device_processor - INFO - Sending start data for proxy 56: {'proxyid': '56', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:25,693 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5556/start "HTTP/1.1 200 OK"
2025-10-21 15:53:25,694 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:25,696 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 56: proxyServiceStart changed to '1'
2025-10-21 15:53:25,697 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 56: {'proxyid': 56, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}}
2025-10-21 15:53:25,697 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:25,699 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:53:25,701 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:53:25,701 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:53:25,702 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:53:25,703 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 56: network OK
2025-10-21 15:53:25,705 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 56 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:25,705 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 56: healthy=True, response_time=0.0
2025-10-21 15:53:25,706 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:25,708 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:53:25,709 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:53:25,710 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:53:25,711 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:53:25,711 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 57 (enabled: 1) ==========
2025-10-21 15:53:25,712 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 57 current status: OK
2025-10-21 15:53:25,712 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 57 <<<<<
2025-10-21 15:53:25,713 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 57 (IP: 127.0.0.1:5557)
2025-10-21 15:53:25,715 - app.services.device_processor - INFO - Checking health for proxy 57 at http://127.0.0.1:5557/Health
2025-10-21 15:53:26,008 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5557/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:26,010 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:26,011 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 57, calling start API
2025-10-21 15:53:26,012 - app.services.device_processor - INFO - Sending start data for proxy 57: {'proxyid': '57', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:26,298 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5557/start "HTTP/1.1 200 OK"
2025-10-21 15:53:26,299 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:26,300 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 57: proxyServiceStart changed to '1'
2025-10-21 15:53:26,301 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 57: {'proxyid': 57, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}}
2025-10-21 15:53:26,302 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:26,303 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:53:26,304 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:53:26,306 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:53:26,306 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:53:26,307 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 57: network OK
2025-10-21 15:53:26,308 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 57 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:26,308 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 57: healthy=True, response_time=0.0
2025-10-21 15:53:26,309 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:26,311 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:53:26,312 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:53:26,312 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:53:26,314 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:53:26,314 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 60 (enabled: 0) ==========
2025-10-21 15:53:26,315 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 60
2025-10-21 15:53:26,316 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 61 (enabled: 0) ==========
2025-10-21 15:53:26,317 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 61
2025-10-21 15:53:26,317 - app.services.background_worker - INFO - [HEALTH_SYNC] Completed health check for 5 devices
2025-10-21 15:53:26,318 - app.services.background_worker - INFO - [BG_WORKER] Background task execution cycle completed
2025-10-21 15:53:26,511 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 15:53:26,513 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 15:53:26,513 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 15:53:26,514 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 15:53:26,515 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 15:53:26,515 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 15:53:26,516 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 15:53:26,747 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5555/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:26,749 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:26,749 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 55, calling start API
2025-10-21 15:53:26,751 - app.services.device_processor - INFO - Sending start data for proxy 55: {'proxyid': '55', 'Controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:27,010 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5555/start "HTTP/1.1 200 OK"
2025-10-21 15:53:27,012 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:27,013 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 55: proxyServiceStart changed to '1'
2025-10-21 15:53:27,014 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 55: {'proxyid': 55, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}}
2025-10-21 15:53:27,014 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:27,016 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:53:27,018 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:53:27,018 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:53:27,019 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:53:27,020 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 55: network OK
2025-10-21 15:53:27,021 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 55 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:27,022 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 55: healthy=True, response_time=0.0
2025-10-21 15:53:27,022 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:27,024 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:53:27,025 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:53:27,026 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:53:27,026 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:53:27,027 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 56 (enabled: 1) ==========
2025-10-21 15:53:27,028 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 56 current status: OK
2025-10-21 15:53:27,028 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 56 <<<<<
2025-10-21 15:53:27,029 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 56 (IP: 127.0.0.1:5556)
2025-10-21 15:53:27,055 - app.services.device_processor - INFO - Checking health for proxy 56 at http://127.0.0.1:5556/Health
2025-10-21 15:53:27,330 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5556/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:27,332 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:27,332 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 56, calling start API
2025-10-21 15:53:27,333 - app.services.device_processor - INFO - Sending start data for proxy 56: {'proxyid': '56', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:27,622 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5556/start "HTTP/1.1 200 OK"
2025-10-21 15:53:27,624 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:27,625 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 56: proxyServiceStart changed to '1'
2025-10-21 15:53:27,626 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 56: {'proxyid': 56, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}}
2025-10-21 15:53:27,626 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:27,628 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:53:27,630 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:53:27,631 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:53:27,632 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:53:27,633 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 56: network OK
2025-10-21 15:53:27,634 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 56 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:27,635 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 56: healthy=True, response_time=0.0
2025-10-21 15:53:27,636 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:27,638 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:53:27,640 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:53:27,641 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:53:27,642 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:53:27,643 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 57 (enabled: 1) ==========
2025-10-21 15:53:27,644 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 57 current status: OK
2025-10-21 15:53:27,644 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 57 <<<<<
2025-10-21 15:53:27,645 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 57 (IP: 127.0.0.1:5557)
2025-10-21 15:53:27,658 - app.services.device_processor - INFO - Checking health for proxy 57 at http://127.0.0.1:5557/Health
2025-10-21 15:53:27,923 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5557/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:27,925 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:27,925 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 57, calling start API
2025-10-21 15:53:27,926 - app.services.device_processor - INFO - Sending start data for proxy 57: {'proxyid': '57', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:28,189 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5557/start "HTTP/1.1 200 OK"
2025-10-21 15:53:28,191 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:28,191 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 57: proxyServiceStart changed to '1'
2025-10-21 15:53:28,192 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 57: {'proxyid': 57, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}}
2025-10-21 15:53:28,194 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:28,196 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:53:28,196 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:53:28,198 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:53:28,198 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:53:28,199 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 57: network OK
2025-10-21 15:53:28,200 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 57 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:28,202 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 57: healthy=True, response_time=0.0
2025-10-21 15:53:28,202 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:28,204 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:53:28,205 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:53:28,206 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:53:28,206 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:53:28,208 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 60 (enabled: 0) ==========
2025-10-21 15:53:28,209 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 60
2025-10-21 15:53:28,209 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 61 (enabled: 0) ==========
2025-10-21 15:53:28,210 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 61
2025-10-21 15:53:28,210 - app.services.background_worker - INFO - [HEALTH_SYNC] Completed health check for 5 devices
2025-10-21 15:53:28,211 - app.services.background_worker - INFO - [BG_WORKER] Background task execution cycle completed
2025-10-21 15:53:28,415 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 15:53:28,415 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 15:53:28,416 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 15:53:28,417 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 15:53:28,418 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 15:53:28,418 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 15:53:28,419 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 15:53:28,725 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5555/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:28,727 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:28,728 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 55, calling start API
2025-10-21 15:53:28,729 - app.services.device_processor - INFO - Sending start data for proxy 55: {'proxyid': '55', 'Controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:29,047 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5555/start "HTTP/1.1 200 OK"
2025-10-21 15:53:29,050 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:29,050 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 55: proxyServiceStart changed to '1'
2025-10-21 15:53:29,051 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 55: {'proxyid': 55, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}}
2025-10-21 15:53:29,053 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:29,055 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:53:29,056 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:53:29,057 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:53:29,058 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:53:29,059 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 55: network OK
2025-10-21 15:53:29,060 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 55 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:29,061 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 55: healthy=True, response_time=0.0
2025-10-21 15:53:29,061 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:29,063 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:53:29,064 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:53:29,066 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:53:29,066 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:53:29,068 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 56 (enabled: 1) ==========
2025-10-21 15:53:29,068 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 56 current status: OK
2025-10-21 15:53:29,069 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 56 <<<<<
2025-10-21 15:53:29,069 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 56 (IP: 127.0.0.1:5556)
2025-10-21 15:53:29,071 - app.services.device_processor - INFO - Checking health for proxy 56 at http://127.0.0.1:5556/Health
2025-10-21 15:53:29,396 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5556/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:29,398 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:29,399 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 56, calling start API
2025-10-21 15:53:29,421 - app.services.device_processor - INFO - Sending start data for proxy 56: {'proxyid': '56', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:29,835 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5556/start "HTTP/1.1 200 OK"
2025-10-21 15:53:29,851 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:29,861 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 56: proxyServiceStart changed to '1'
2025-10-21 15:53:29,865 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 56: {'proxyid': 56, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}}
2025-10-21 15:53:29,866 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:29,872 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:53:29,875 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:53:29,879 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:53:29,881 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 56: network OK
2025-10-21 15:53:29,885 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 56 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:29,888 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 56: healthy=True, response_time=0.0
2025-10-21 15:53:29,889 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:29,892 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:53:29,894 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:53:29,896 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:53:29,896 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:53:29,897 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:53:29,899 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 57 (enabled: 1) ==========
2025-10-21 15:53:29,900 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 57 current status: OK
2025-10-21 15:53:29,901 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 57 <<<<<
2025-10-21 15:53:29,902 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 57 (IP: 127.0.0.1:5557)
2025-10-21 15:53:29,918 - app.services.device_processor - INFO - Checking health for proxy 57 at http://127.0.0.1:5557/Health
2025-10-21 15:53:30,223 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5557/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:30,225 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:30,226 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 57, calling start API
2025-10-21 15:53:30,239 - app.services.device_processor - INFO - Sending start data for proxy 57: {'proxyid': '57', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:30,552 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5557/start "HTTP/1.1 200 OK"
2025-10-21 15:53:30,554 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:30,554 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 57: proxyServiceStart changed to '1'
2025-10-21 15:53:30,555 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 57: {'proxyid': 57, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}}
2025-10-21 15:53:30,556 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:30,557 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:53:30,559 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:53:30,561 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:53:30,563 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:53:30,563 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 57: network OK
2025-10-21 15:53:30,565 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 57 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:30,566 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 57: healthy=True, response_time=0.0
2025-10-21 15:53:30,567 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:30,569 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:53:30,571 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:53:30,572 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:53:30,573 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:53:30,574 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 60 (enabled: 0) ==========
2025-10-21 15:53:30,574 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 60
2025-10-21 15:53:30,575 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 61 (enabled: 0) ==========
2025-10-21 15:53:30,576 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 61
2025-10-21 15:53:30,576 - app.services.background_worker - INFO - [HEALTH_SYNC] Completed health check for 5 devices
2025-10-21 15:53:30,577 - app.services.background_worker - INFO - [BG_WORKER] Background task execution cycle completed
2025-10-21 15:53:30,762 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 15:53:30,762 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 15:53:30,763 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 15:53:30,764 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 15:53:30,764 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 15:53:30,766 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 15:53:30,767 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 15:53:31,093 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5555/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:31,095 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:31,096 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 55, calling start API
2025-10-21 15:53:31,117 - app.services.device_processor - INFO - Sending start data for proxy 55: {'proxyid': '55', 'Controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:31,385 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5555/start "HTTP/1.1 200 OK"
2025-10-21 15:53:31,386 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:31,387 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 55: proxyServiceStart changed to '1'
2025-10-21 15:53:31,388 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 55: {'proxyid': 55, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}}
2025-10-21 15:53:31,389 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:31,391 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:53:31,392 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:53:31,393 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:53:31,394 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:53:31,395 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 55: network OK
2025-10-21 15:53:31,397 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 55 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:31,397 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 55: healthy=True, response_time=0.0
2025-10-21 15:53:31,398 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:31,401 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:53:31,402 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:53:31,403 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:53:31,404 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:53:31,405 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 56 (enabled: 1) ==========
2025-10-21 15:53:31,405 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 56 current status: OK
2025-10-21 15:53:31,406 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 56 <<<<<
2025-10-21 15:53:31,407 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 56 (IP: 127.0.0.1:5556)
2025-10-21 15:53:31,407 - app.services.device_processor - INFO - Checking health for proxy 56 at http://127.0.0.1:5556/Health
2025-10-21 15:53:31,698 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5556/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:31,700 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:31,701 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 56, calling start API
2025-10-21 15:53:31,721 - app.services.device_processor - INFO - Sending start data for proxy 56: {'proxyid': '56', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:32,026 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5556/start "HTTP/1.1 200 OK"
2025-10-21 15:53:32,028 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:32,029 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 56: proxyServiceStart changed to '1'
2025-10-21 15:53:32,030 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 56: {'proxyid': 56, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}}
2025-10-21 15:53:32,030 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:32,033 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:53:32,034 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:53:32,035 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:53:32,036 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:53:32,037 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 56: network OK
2025-10-21 15:53:32,038 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 56 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:32,039 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 56: healthy=True, response_time=0.0
2025-10-21 15:53:32,039 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:32,041 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:53:32,042 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:53:32,043 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:53:32,044 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:53:32,045 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 57 (enabled: 1) ==========
2025-10-21 15:53:32,045 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 57 current status: OK
2025-10-21 15:53:32,046 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 57 <<<<<
2025-10-21 15:53:32,046 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 57 (IP: 127.0.0.1:5557)
2025-10-21 15:53:32,063 - app.services.device_processor - INFO - Checking health for proxy 57 at http://127.0.0.1:5557/Health
2025-10-21 15:53:32,352 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5557/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:32,354 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:32,355 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 57, calling start API
2025-10-21 15:53:32,374 - app.services.device_processor - INFO - Sending start data for proxy 57: {'proxyid': '57', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:32,649 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5557/start "HTTP/1.1 200 OK"
2025-10-21 15:53:32,652 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:32,652 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 57: proxyServiceStart changed to '1'
2025-10-21 15:53:32,653 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 57: {'proxyid': 57, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}}
2025-10-21 15:53:32,653 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:32,656 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:53:32,657 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:53:32,658 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:53:32,659 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:53:32,659 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 57: network OK
2025-10-21 15:53:32,662 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 57 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:32,662 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 57: healthy=True, response_time=0.0
2025-10-21 15:53:32,663 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:32,665 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:53:32,666 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:53:32,668 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:53:32,668 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:53:32,669 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 60 (enabled: 0) ==========
2025-10-21 15:53:32,670 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 60
2025-10-21 15:53:32,670 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 61 (enabled: 0) ==========
2025-10-21 15:53:32,671 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 61
2025-10-21 15:53:32,672 - app.services.background_worker - INFO - [HEALTH_SYNC] Completed health check for 5 devices
2025-10-21 15:53:32,672 - app.services.background_worker - INFO - [BG_WORKER] Background task execution cycle completed
2025-10-21 15:53:32,853 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 15:53:32,854 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 15:53:32,855 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 15:53:32,856 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 15:53:32,857 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 15:53:32,857 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 15:53:32,858 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 15:53:33,123 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5555/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:33,125 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:33,127 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 55, calling start API
2025-10-21 15:53:33,128 - app.services.device_processor - INFO - Sending start data for proxy 55: {'proxyid': '55', 'Controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:33,419 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5555/start "HTTP/1.1 200 OK"
2025-10-21 15:53:33,420 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:33,421 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 55: proxyServiceStart changed to '1'
2025-10-21 15:53:33,422 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 55: {'proxyid': 55, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}}
2025-10-21 15:53:33,422 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:33,424 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:53:33,425 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:53:33,426 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:53:33,427 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:53:33,428 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 55: network OK
2025-10-21 15:53:33,429 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 55 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:33,429 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 55: healthy=True, response_time=0.0
2025-10-21 15:53:33,430 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:33,431 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:53:33,433 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:53:33,434 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:53:33,435 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:53:33,436 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 56 (enabled: 1) ==========
2025-10-21 15:53:33,436 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 56 current status: OK
2025-10-21 15:53:33,437 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 56 <<<<<
2025-10-21 15:53:33,437 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 56 (IP: 127.0.0.1:5556)
2025-10-21 15:53:33,438 - app.services.device_processor - INFO - Checking health for proxy 56 at http://127.0.0.1:5556/Health
2025-10-21 15:53:33,729 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5556/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:33,731 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:33,731 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 56, calling start API
2025-10-21 15:53:33,751 - app.services.device_processor - INFO - Sending start data for proxy 56: {'proxyid': '56', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:34,048 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5556/start "HTTP/1.1 200 OK"
2025-10-21 15:53:34,050 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:34,050 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 56: proxyServiceStart changed to '1'
2025-10-21 15:53:34,051 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 56: {'proxyid': 56, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}}
2025-10-21 15:53:34,052 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:34,053 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:53:34,054 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:53:34,056 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:53:34,057 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:53:34,057 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 56: network OK
2025-10-21 15:53:34,059 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 56 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:34,059 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 56: healthy=True, response_time=0.0
2025-10-21 15:53:34,060 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:34,061 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:53:34,063 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:53:34,064 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:53:34,065 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:53:34,066 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 57 (enabled: 1) ==========
2025-10-21 15:53:34,066 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 57 current status: OK
2025-10-21 15:53:34,067 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 57 <<<<<
2025-10-21 15:53:34,067 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 57 (IP: 127.0.0.1:5557)
2025-10-21 15:53:34,090 - app.services.device_processor - INFO - Checking health for proxy 57 at http://127.0.0.1:5557/Health
2025-10-21 15:53:34,368 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5557/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:34,369 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:34,370 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 57, calling start API
2025-10-21 15:53:34,371 - app.services.device_processor - INFO - Sending start data for proxy 57: {'proxyid': '57', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:34,655 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5557/start "HTTP/1.1 200 OK"
2025-10-21 15:53:34,657 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:34,657 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 57: proxyServiceStart changed to '1'
2025-10-21 15:53:34,659 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 57: {'proxyid': 57, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}}
2025-10-21 15:53:34,659 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:34,661 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:53:34,662 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:53:34,663 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:53:34,664 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:53:34,664 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 57: network OK
2025-10-21 15:53:34,666 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 57 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:34,667 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 57: healthy=True, response_time=0.0
2025-10-21 15:53:34,667 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:34,668 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:53:34,671 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:53:34,671 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:53:34,672 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:53:34,673 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 60 (enabled: 0) ==========
2025-10-21 15:53:34,673 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 60
2025-10-21 15:53:34,674 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 61 (enabled: 0) ==========
2025-10-21 15:53:34,674 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 61
2025-10-21 15:53:34,675 - app.services.background_worker - INFO - [HEALTH_SYNC] Completed health check for 5 devices
2025-10-21 15:53:34,675 - app.services.background_worker - INFO - [BG_WORKER] Background task execution cycle completed
2025-10-21 15:53:34,869 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 15:53:34,870 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 15:53:34,871 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 15:53:34,872 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 15:53:34,872 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 15:53:34,873 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 15:53:34,874 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 15:53:35,148 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5555/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:35,149 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:35,151 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 55, calling start API
2025-10-21 15:53:35,163 - app.services.device_processor - INFO - Sending start data for proxy 55: {'proxyid': '55', 'Controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:35,491 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5555/start "HTTP/1.1 200 OK"
2025-10-21 15:53:35,492 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:35,494 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 55: proxyServiceStart changed to '1'
2025-10-21 15:53:35,495 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 55: {'proxyid': 55, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}}
2025-10-21 15:53:35,495 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:35,497 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:53:35,498 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:53:35,500 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:53:35,501 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:53:35,501 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 55: network OK
2025-10-21 15:53:35,502 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 55 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:35,503 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 55: healthy=True, response_time=0.0
2025-10-21 15:53:35,504 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:35,506 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:53:35,507 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:53:35,508 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:53:35,509 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:53:35,510 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 56 (enabled: 1) ==========
2025-10-21 15:53:35,510 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 56 current status: OK
2025-10-21 15:53:35,511 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 56 <<<<<
2025-10-21 15:53:35,512 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 56 (IP: 127.0.0.1:5556)
2025-10-21 15:53:35,513 - app.services.device_processor - INFO - Checking health for proxy 56 at http://127.0.0.1:5556/Health
2025-10-21 15:53:35,786 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5556/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:35,788 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:35,789 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 56, calling start API
2025-10-21 15:53:35,808 - app.services.device_processor - INFO - Sending start data for proxy 56: {'proxyid': '56', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:36,078 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5556/start "HTTP/1.1 200 OK"
2025-10-21 15:53:36,079 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:36,080 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 56: proxyServiceStart changed to '1'
2025-10-21 15:53:36,081 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 56: {'proxyid': 56, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}}
2025-10-21 15:53:36,081 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:36,084 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:53:36,085 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:53:36,086 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:53:36,087 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:53:36,087 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 56: network OK
2025-10-21 15:53:36,089 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 56 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:36,090 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 56: healthy=True, response_time=0.0
2025-10-21 15:53:36,090 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:36,092 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:53:36,093 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:53:36,094 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:53:36,095 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:53:36,096 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 57 (enabled: 1) ==========
2025-10-21 15:53:36,096 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 57 current status: OK
2025-10-21 15:53:36,097 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 57 <<<<<
2025-10-21 15:53:36,097 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 57 (IP: 127.0.0.1:5557)
2025-10-21 15:53:36,099 - app.services.device_processor - INFO - Checking health for proxy 57 at http://127.0.0.1:5557/Health
2025-10-21 15:53:36,388 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5557/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:36,389 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:36,390 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 57, calling start API
2025-10-21 15:53:36,391 - app.services.device_processor - INFO - Sending start data for proxy 57: {'proxyid': '57', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:36,695 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5557/start "HTTP/1.1 200 OK"
2025-10-21 15:53:36,696 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:36,697 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 57: proxyServiceStart changed to '1'
2025-10-21 15:53:36,698 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 57: {'proxyid': 57, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}}
2025-10-21 15:53:36,699 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:36,701 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:53:36,703 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:53:36,704 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:53:36,705 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:53:36,706 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 57: network OK
2025-10-21 15:53:36,708 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 57 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:36,709 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 57: healthy=True, response_time=0.0
2025-10-21 15:53:36,709 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:36,711 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:53:36,712 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:53:36,713 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:53:36,714 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:53:36,715 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 60 (enabled: 0) ==========
2025-10-21 15:53:36,716 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 60
2025-10-21 15:53:36,717 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 61 (enabled: 0) ==========
2025-10-21 15:53:36,717 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 61
2025-10-21 15:53:36,718 - app.services.background_worker - INFO - [HEALTH_SYNC] Completed health check for 5 devices
2025-10-21 15:53:36,719 - app.services.background_worker - INFO - [BG_WORKER] Background task execution cycle completed
2025-10-21 15:53:36,905 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 15:53:36,905 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 15:53:36,907 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 15:53:36,908 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 15:53:36,908 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 15:53:36,909 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 15:53:36,911 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 15:53:37,298 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5555/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:37,300 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:37,300 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 55, calling start API
2025-10-21 15:53:37,322 - app.services.device_processor - INFO - Sending start data for proxy 55: {'proxyid': '55', 'Controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:37,637 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5555/start "HTTP/1.1 200 OK"
2025-10-21 15:53:37,639 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:37,640 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 55: proxyServiceStart changed to '1'
2025-10-21 15:53:37,642 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 55: {'proxyid': 55, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}}
2025-10-21 15:53:37,643 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:37,645 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:53:37,647 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:53:37,648 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:53:37,648 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:53:37,650 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 55: network OK
2025-10-21 15:53:37,652 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 55 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:37,652 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 55: healthy=True, response_time=0.0
2025-10-21 15:53:37,653 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:37,654 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:53:37,657 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:53:37,658 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:53:37,659 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:53:37,660 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 56 (enabled: 1) ==========
2025-10-21 15:53:37,661 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 56 current status: OK
2025-10-21 15:53:37,662 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 56 <<<<<
2025-10-21 15:53:37,662 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 56 (IP: 127.0.0.1:5556)
2025-10-21 15:53:37,680 - app.services.device_processor - INFO - Checking health for proxy 56 at http://127.0.0.1:5556/Health
2025-10-21 15:53:38,011 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5556/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:38,014 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:38,014 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 56, calling start API
2025-10-21 15:53:38,037 - app.services.device_processor - INFO - Sending start data for proxy 56: {'proxyid': '56', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:38,369 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5556/start "HTTP/1.1 200 OK"
2025-10-21 15:53:38,370 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:38,371 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 56: proxyServiceStart changed to '1'
2025-10-21 15:53:38,372 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 56: {'proxyid': 56, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}}
2025-10-21 15:53:38,373 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:38,375 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:53:38,376 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:53:38,377 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:53:38,379 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:53:38,379 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 56: network OK
2025-10-21 15:53:38,381 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 56 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:38,381 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 56: healthy=True, response_time=0.0
2025-10-21 15:53:38,382 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:38,385 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:53:38,386 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:53:38,388 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:53:38,388 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:53:38,389 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 57 (enabled: 1) ==========
2025-10-21 15:53:38,390 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 57 current status: OK
2025-10-21 15:53:38,391 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 57 <<<<<
2025-10-21 15:53:38,392 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 57 (IP: 127.0.0.1:5557)
2025-10-21 15:53:38,393 - app.services.device_processor - INFO - Checking health for proxy 57 at http://127.0.0.1:5557/Health
2025-10-21 15:53:38,696 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5557/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:38,697 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:38,698 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 57, calling start API
2025-10-21 15:53:38,698 - app.services.device_processor - INFO - Sending start data for proxy 57: {'proxyid': '57', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:38,981 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5557/start "HTTP/1.1 200 OK"
2025-10-21 15:53:38,983 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:38,984 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 57: proxyServiceStart changed to '1'
2025-10-21 15:53:38,985 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 57: {'proxyid': 57, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}}
2025-10-21 15:53:38,985 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:38,987 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:53:38,988 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:53:38,989 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:53:38,990 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:53:38,991 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 57: network OK
2025-10-21 15:53:38,992 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 57 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:38,993 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 57: healthy=True, response_time=0.0
2025-10-21 15:53:38,994 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:38,995 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:53:38,997 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:53:38,998 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:53:38,999 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:53:39,000 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 60 (enabled: 0) ==========
2025-10-21 15:53:39,000 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 60
2025-10-21 15:53:39,001 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 61 (enabled: 0) ==========
2025-10-21 15:53:39,001 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 61
2025-10-21 15:53:39,002 - app.services.background_worker - INFO - [HEALTH_SYNC] Completed health check for 5 devices
2025-10-21 15:53:39,003 - app.services.background_worker - INFO - [BG_WORKER] Background task execution cycle completed
2025-10-21 15:53:39,182 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 15:53:39,183 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 15:53:39,183 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 15:53:39,193 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 15:53:39,194 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 15:53:39,194 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 15:53:39,213 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 15:53:39,474 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5555/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:39,476 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:39,477 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 55, calling start API
2025-10-21 15:53:39,491 - app.services.device_processor - INFO - Sending start data for proxy 55: {'proxyid': '55', 'Controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:39,772 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5555/start "HTTP/1.1 200 OK"
2025-10-21 15:53:39,773 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:39,774 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 55: proxyServiceStart changed to '1'
2025-10-21 15:53:39,775 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 55: {'proxyid': 55, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}}
2025-10-21 15:53:39,776 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:39,777 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:53:39,778 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:53:39,779 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:53:39,780 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:53:39,781 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 55: network OK
2025-10-21 15:53:39,782 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 55 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:39,783 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 55: healthy=True, response_time=0.0
2025-10-21 15:53:39,783 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:39,786 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:53:39,787 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:53:39,788 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:53:39,788 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:53:39,789 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 56 (enabled: 1) ==========
2025-10-21 15:53:39,789 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 56 current status: OK
2025-10-21 15:53:39,790 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 56 <<<<<
2025-10-21 15:53:39,791 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 56 (IP: 127.0.0.1:5556)
2025-10-21 15:53:39,792 - app.services.device_processor - INFO - Checking health for proxy 56 at http://127.0.0.1:5556/Health
2025-10-21 15:53:40,084 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5556/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:40,087 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:40,088 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 56, calling start API
2025-10-21 15:53:40,109 - app.services.device_processor - INFO - Sending start data for proxy 56: {'proxyid': '56', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:40,387 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5556/start "HTTP/1.1 200 OK"
2025-10-21 15:53:40,389 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:40,390 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 56: proxyServiceStart changed to '1'
2025-10-21 15:53:40,391 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 56: {'proxyid': 56, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}}
2025-10-21 15:53:40,391 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:40,393 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:53:40,394 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:53:40,395 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:53:40,396 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:53:40,396 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 56: network OK
2025-10-21 15:53:40,398 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 56 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:40,399 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 56: healthy=True, response_time=0.0
2025-10-21 15:53:40,399 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:40,401 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:53:40,403 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:53:40,403 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:53:40,404 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:53:40,405 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 57 (enabled: 1) ==========
2025-10-21 15:53:40,405 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 57 current status: OK
2025-10-21 15:53:40,406 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 57 <<<<<
2025-10-21 15:53:40,407 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 57 (IP: 127.0.0.1:5557)
2025-10-21 15:53:40,408 - app.services.device_processor - INFO - Checking health for proxy 57 at http://127.0.0.1:5557/Health
2025-10-21 15:53:40,659 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5557/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:40,661 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:40,662 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 57, calling start API
2025-10-21 15:53:40,663 - app.services.device_processor - INFO - Sending start data for proxy 57: {'proxyid': '57', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:40,939 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5557/start "HTTP/1.1 200 OK"
2025-10-21 15:53:40,941 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:40,942 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 57: proxyServiceStart changed to '1'
2025-10-21 15:53:40,943 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 57: {'proxyid': 57, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}}
2025-10-21 15:53:40,943 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:40,945 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:53:40,947 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:53:40,948 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:53:40,949 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:53:40,950 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 57: network OK
2025-10-21 15:53:40,951 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 57 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:40,952 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 57: healthy=True, response_time=0.0
2025-10-21 15:53:40,952 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:40,954 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:53:40,956 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:53:40,957 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:53:40,958 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:53:40,958 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 60 (enabled: 0) ==========
2025-10-21 15:53:40,959 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 60
2025-10-21 15:53:40,959 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 61 (enabled: 0) ==========
2025-10-21 15:53:40,960 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 61
2025-10-21 15:53:40,960 - app.services.background_worker - INFO - [HEALTH_SYNC] Completed health check for 5 devices
2025-10-21 15:53:40,961 - app.services.background_worker - INFO - [BG_WORKER] Background task execution cycle completed
2025-10-21 15:53:41,162 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 15:53:41,163 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 15:53:41,164 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 15:53:41,165 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 15:53:41,166 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 15:53:41,166 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 15:53:41,168 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 15:53:41,453 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5555/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:41,455 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:41,456 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 55, calling start API
2025-10-21 15:53:41,470 - app.services.device_processor - INFO - Sending start data for proxy 55: {'proxyid': '55', 'Controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:41,753 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5555/start "HTTP/1.1 200 OK"
2025-10-21 15:53:41,754 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:41,755 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 55: proxyServiceStart changed to '1'
2025-10-21 15:53:41,756 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 55: {'proxyid': 55, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}}
2025-10-21 15:53:41,757 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:41,758 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:53:41,759 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:53:41,761 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:53:41,762 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:53:41,763 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 55: network OK
2025-10-21 15:53:41,764 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 55 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:41,764 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 55: healthy=True, response_time=0.0
2025-10-21 15:53:41,765 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:41,767 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:53:41,768 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:53:41,769 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:53:41,769 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:53:41,770 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 56 (enabled: 1) ==========
2025-10-21 15:53:41,777 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 56 current status: OK
2025-10-21 15:53:41,778 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 56 <<<<<
2025-10-21 15:53:41,779 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 56 (IP: 127.0.0.1:5556)
2025-10-21 15:53:41,780 - app.services.device_processor - INFO - Checking health for proxy 56 at http://127.0.0.1:5556/Health
2025-10-21 15:53:42,058 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5556/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:42,060 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:42,061 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 56, calling start API
2025-10-21 15:53:42,063 - app.services.device_processor - INFO - Sending start data for proxy 56: {'proxyid': '56', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:42,320 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5556/start "HTTP/1.1 200 OK"
2025-10-21 15:53:42,322 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:42,323 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 56: proxyServiceStart changed to '1'
2025-10-21 15:53:42,324 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 56: {'proxyid': 56, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}}
2025-10-21 15:53:42,325 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:42,329 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:53:42,330 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:53:42,331 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:53:42,332 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:53:42,333 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 56: network OK
2025-10-21 15:53:42,335 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 56 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:42,335 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 56: healthy=True, response_time=0.0
2025-10-21 15:53:42,336 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:42,338 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:53:42,339 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:53:42,340 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:53:42,341 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:53:42,341 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 57 (enabled: 1) ==========
2025-10-21 15:53:42,342 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 57 current status: OK
2025-10-21 15:53:42,342 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 57 <<<<<
2025-10-21 15:53:42,343 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 57 (IP: 127.0.0.1:5557)
2025-10-21 15:53:42,344 - app.services.device_processor - INFO - Checking health for proxy 57 at http://127.0.0.1:5557/Health
2025-10-21 15:53:42,629 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5557/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:42,631 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:42,631 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 57, calling start API
2025-10-21 15:53:42,649 - app.services.device_processor - INFO - Sending start data for proxy 57: {'proxyid': '57', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:42,931 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5557/start "HTTP/1.1 200 OK"
2025-10-21 15:53:42,932 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:42,933 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 57: proxyServiceStart changed to '1'
2025-10-21 15:53:42,934 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 57: {'proxyid': 57, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}}
2025-10-21 15:53:42,935 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:42,936 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:53:42,937 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:53:42,938 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:53:42,939 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:53:42,939 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 57: network OK
2025-10-21 15:53:42,941 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 57 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:42,941 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 57: healthy=True, response_time=0.0
2025-10-21 15:53:42,942 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:42,943 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:53:42,945 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:53:42,945 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:53:42,946 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:53:42,946 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 60 (enabled: 0) ==========
2025-10-21 15:53:42,948 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 60
2025-10-21 15:53:42,948 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 61 (enabled: 0) ==========
2025-10-21 15:53:42,949 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 61
2025-10-21 15:53:42,949 - app.services.background_worker - INFO - [HEALTH_SYNC] Completed health check for 5 devices
2025-10-21 15:53:42,950 - app.services.background_worker - INFO - [BG_WORKER] Background task execution cycle completed
2025-10-21 15:53:43,161 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 15:53:43,161 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 15:53:43,161 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 15:53:43,162 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 15:53:43,163 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 15:53:43,163 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 15:53:43,164 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 15:53:43,394 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5555/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:43,396 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:43,396 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 55, calling start API
2025-10-21 15:53:43,397 - app.services.device_processor - INFO - Sending start data for proxy 55: {'proxyid': '55', 'Controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:43,657 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5555/start "HTTP/1.1 200 OK"
2025-10-21 15:53:43,658 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:43,658 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 55: proxyServiceStart changed to '1'
2025-10-21 15:53:43,659 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 55: {'proxyid': 55, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}}
2025-10-21 15:53:43,660 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:43,661 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:53:43,663 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:53:43,664 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:53:43,664 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:53:43,665 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 55: network OK
2025-10-21 15:53:43,666 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 55 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:43,667 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 55: healthy=True, response_time=0.0
2025-10-21 15:53:43,667 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:43,669 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:53:43,670 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:53:43,671 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:53:43,671 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:53:43,672 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 56 (enabled: 1) ==========
2025-10-21 15:53:43,673 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 56 current status: OK
2025-10-21 15:53:43,673 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 56 <<<<<
2025-10-21 15:53:43,674 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 56 (IP: 127.0.0.1:5556)
2025-10-21 15:53:43,675 - app.services.device_processor - INFO - Checking health for proxy 56 at http://127.0.0.1:5556/Health
2025-10-21 15:53:43,942 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5556/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:43,943 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:43,943 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 56, calling start API
2025-10-21 15:53:43,967 - app.services.device_processor - INFO - Sending start data for proxy 56: {'proxyid': '56', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:44,251 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5556/start "HTTP/1.1 200 OK"
2025-10-21 15:53:44,254 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:44,254 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 56: proxyServiceStart changed to '1'
2025-10-21 15:53:44,255 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 56: {'proxyid': 56, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}}
2025-10-21 15:53:44,256 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:44,257 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:53:44,259 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:53:44,260 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:53:44,260 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:53:44,262 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 56: network OK
2025-10-21 15:53:44,263 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 56 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:44,264 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 56: healthy=True, response_time=0.0
2025-10-21 15:53:44,264 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:44,267 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:53:44,268 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:53:44,269 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:53:44,270 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:53:44,271 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 57 (enabled: 1) ==========
2025-10-21 15:53:44,272 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 57 current status: OK
2025-10-21 15:53:44,273 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 57 <<<<<
2025-10-21 15:53:44,273 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 57 (IP: 127.0.0.1:5557)
2025-10-21 15:53:44,274 - app.services.device_processor - INFO - Checking health for proxy 57 at http://127.0.0.1:5557/Health
2025-10-21 15:53:44,581 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5557/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:44,583 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:44,584 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 57, calling start API
2025-10-21 15:53:44,585 - app.services.device_processor - INFO - Sending start data for proxy 57: {'proxyid': '57', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:44,841 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5557/start "HTTP/1.1 200 OK"
2025-10-21 15:53:44,842 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:44,843 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 57: proxyServiceStart changed to '1'
2025-10-21 15:53:44,843 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 57: {'proxyid': 57, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}}
2025-10-21 15:53:44,844 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:44,846 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:53:44,847 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:53:44,848 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:53:44,849 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:53:44,850 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 57: network OK
2025-10-21 15:53:44,851 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 57 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:44,851 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 57: healthy=True, response_time=0.0
2025-10-21 15:53:44,852 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:44,854 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:53:44,855 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:53:44,856 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:53:44,857 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:53:44,857 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 60 (enabled: 0) ==========
2025-10-21 15:53:44,858 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 60
2025-10-21 15:53:44,859 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 61 (enabled: 0) ==========
2025-10-21 15:53:44,859 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 61
2025-10-21 15:53:44,860 - app.services.background_worker - INFO - [HEALTH_SYNC] Completed health check for 5 devices
2025-10-21 15:53:44,860 - app.services.background_worker - INFO - [BG_WORKER] Background task execution cycle completed
2025-10-21 15:53:45,065 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 15:53:45,066 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 15:53:45,067 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 15:53:45,067 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 15:53:45,068 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 15:53:45,069 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 15:53:45,080 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 15:53:45,384 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5555/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:45,386 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:45,387 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 55, calling start API
2025-10-21 15:53:45,389 - app.services.device_processor - INFO - Sending start data for proxy 55: {'proxyid': '55', 'Controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:45,686 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5555/start "HTTP/1.1 200 OK"
2025-10-21 15:53:45,688 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:45,689 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 55: proxyServiceStart changed to '1'
2025-10-21 15:53:45,689 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 55: {'proxyid': 55, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}}
2025-10-21 15:53:45,691 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:45,693 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:53:45,694 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:53:45,695 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:53:45,695 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:53:45,697 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 55: network OK
2025-10-21 15:53:45,698 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 55 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:45,699 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 55: healthy=True, response_time=0.0
2025-10-21 15:53:45,700 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:45,701 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:53:45,703 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:53:45,704 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:53:45,704 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:53:45,706 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 56 (enabled: 1) ==========
2025-10-21 15:53:45,707 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 56 current status: OK
2025-10-21 15:53:45,707 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 56 <<<<<
2025-10-21 15:53:45,708 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 56 (IP: 127.0.0.1:5556)
2025-10-21 15:53:45,726 - app.services.device_processor - INFO - Checking health for proxy 56 at http://127.0.0.1:5556/Health
2025-10-21 15:53:46,053 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5556/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:46,054 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:46,055 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 56, calling start API
2025-10-21 15:53:46,057 - app.services.device_processor - INFO - Sending start data for proxy 56: {'proxyid': '56', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:46,347 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5556/start "HTTP/1.1 200 OK"
2025-10-21 15:53:46,349 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:46,350 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 56: proxyServiceStart changed to '1'
2025-10-21 15:53:46,351 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 56: {'proxyid': 56, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}}
2025-10-21 15:53:46,352 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:46,353 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:53:46,355 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:53:46,356 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:53:46,358 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:53:46,358 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 56: network OK
2025-10-21 15:53:46,360 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 56 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:46,360 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 56: healthy=True, response_time=0.0
2025-10-21 15:53:46,361 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:46,362 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:53:46,364 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:53:46,365 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:53:46,365 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:53:46,367 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 57 (enabled: 1) ==========
2025-10-21 15:53:46,367 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 57 current status: OK
2025-10-21 15:53:46,368 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 57 <<<<<
2025-10-21 15:53:46,368 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 57 (IP: 127.0.0.1:5557)
2025-10-21 15:53:46,370 - app.services.device_processor - INFO - Checking health for proxy 57 at http://127.0.0.1:5557/Health
2025-10-21 15:53:46,658 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5557/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:46,660 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:46,661 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 57, calling start API
2025-10-21 15:53:46,685 - app.services.device_processor - INFO - Sending start data for proxy 57: {'proxyid': '57', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:46,983 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5557/start "HTTP/1.1 200 OK"
2025-10-21 15:53:46,984 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:46,985 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 57: proxyServiceStart changed to '1'
2025-10-21 15:53:46,986 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 57: {'proxyid': 57, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}}
2025-10-21 15:53:46,986 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:46,989 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:53:46,990 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:53:46,991 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:53:46,992 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 57: network OK
2025-10-21 15:53:46,992 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:53:46,993 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 57 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:46,994 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 57: healthy=True, response_time=0.0
2025-10-21 15:53:46,994 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:46,997 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:53:46,998 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:53:46,999 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:53:47,000 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:53:47,001 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 60 (enabled: 0) ==========
2025-10-21 15:53:47,001 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 60
2025-10-21 15:53:47,002 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 61 (enabled: 0) ==========
2025-10-21 15:53:47,003 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 61
2025-10-21 15:53:47,004 - app.services.background_worker - INFO - [HEALTH_SYNC] Completed health check for 5 devices
2025-10-21 15:53:47,004 - app.services.background_worker - INFO - [BG_WORKER] Background task execution cycle completed
2025-10-21 15:53:47,198 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 15:53:47,198 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 15:53:47,199 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 15:53:47,200 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 15:53:47,200 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 15:53:47,201 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 15:53:47,202 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 15:53:47,466 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5555/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:47,468 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:47,468 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 55, calling start API
2025-10-21 15:53:47,469 - app.services.device_processor - INFO - Sending start data for proxy 55: {'proxyid': '55', 'Controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:47,717 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5555/start "HTTP/1.1 200 OK"
2025-10-21 15:53:47,719 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:47,719 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 55: proxyServiceStart changed to '1'
2025-10-21 15:53:47,720 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 55: {'proxyid': 55, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}}
2025-10-21 15:53:47,720 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:47,722 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:53:47,724 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:53:47,725 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:53:47,726 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:53:47,726 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 55: network OK
2025-10-21 15:53:47,728 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 55 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:47,728 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 55: healthy=True, response_time=0.0
2025-10-21 15:53:47,729 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:47,730 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:53:47,732 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:53:47,733 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:53:47,733 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:53:47,734 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 56 (enabled: 1) ==========
2025-10-21 15:53:47,735 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 56 current status: OK
2025-10-21 15:53:47,735 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 56 <<<<<
2025-10-21 15:53:47,736 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 56 (IP: 127.0.0.1:5556)
2025-10-21 15:53:47,754 - app.services.device_processor - INFO - Checking health for proxy 56 at http://127.0.0.1:5556/Health
2025-10-21 15:53:48,008 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5556/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:48,012 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:48,012 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 56, calling start API
2025-10-21 15:53:48,034 - app.services.device_processor - INFO - Sending start data for proxy 56: {'proxyid': '56', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:48,341 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5556/start "HTTP/1.1 200 OK"
2025-10-21 15:53:48,343 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:48,344 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 56: proxyServiceStart changed to '1'
2025-10-21 15:53:48,345 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 56: {'proxyid': 56, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}}
2025-10-21 15:53:48,345 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:48,348 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:53:48,349 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:53:48,351 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:53:48,351 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:53:48,352 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 56: network OK
2025-10-21 15:53:48,353 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 56 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:48,354 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 56: healthy=True, response_time=0.0
2025-10-21 15:53:48,355 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:48,356 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:53:48,358 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:53:48,359 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:53:48,359 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:53:48,361 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 57 (enabled: 1) ==========
2025-10-21 15:53:48,361 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 57 current status: OK
2025-10-21 15:53:48,362 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 57 <<<<<
2025-10-21 15:53:48,362 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 57 (IP: 127.0.0.1:5557)
2025-10-21 15:53:48,364 - app.services.device_processor - INFO - Checking health for proxy 57 at http://127.0.0.1:5557/Health
2025-10-21 15:53:48,680 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5557/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:48,683 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:48,684 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 57, calling start API
2025-10-21 15:53:48,685 - app.services.device_processor - INFO - Sending start data for proxy 57: {'proxyid': '57', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:48,977 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5557/start "HTTP/1.1 200 OK"
2025-10-21 15:53:48,978 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:48,978 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 57: proxyServiceStart changed to '1'
2025-10-21 15:53:48,980 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 57: {'proxyid': 57, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}}
2025-10-21 15:53:48,981 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:48,982 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:53:48,983 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:53:48,984 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:53:48,985 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:53:48,986 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 57: network OK
2025-10-21 15:53:48,987 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 57 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:48,987 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 57: healthy=True, response_time=0.0
2025-10-21 15:53:48,988 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:48,990 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:53:48,991 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:53:48,992 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:53:48,993 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:53:48,993 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 60 (enabled: 0) ==========
2025-10-21 15:53:48,994 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 60
2025-10-21 15:53:48,995 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 61 (enabled: 0) ==========
2025-10-21 15:53:48,995 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 61
2025-10-21 15:53:48,996 - app.services.background_worker - INFO - [HEALTH_SYNC] Completed health check for 5 devices
2025-10-21 15:53:48,997 - app.services.background_worker - INFO - [BG_WORKER] Background task execution cycle completed
2025-10-21 15:53:49,185 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 15:53:49,186 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 15:53:49,187 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 15:53:49,188 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 15:53:49,188 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 15:53:49,190 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 15:53:49,215 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 15:53:49,451 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5555/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:49,453 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:49,453 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 55, calling start API
2025-10-21 15:53:49,454 - app.services.device_processor - INFO - Sending start data for proxy 55: {'proxyid': '55', 'Controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:49,711 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5555/start "HTTP/1.1 200 OK"
2025-10-21 15:53:49,713 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:49,713 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 55: proxyServiceStart changed to '1'
2025-10-21 15:53:49,714 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 55: {'proxyid': 55, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}}
2025-10-21 15:53:49,715 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:49,717 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:53:49,718 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:53:49,719 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:53:49,720 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:53:49,721 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 55: network OK
2025-10-21 15:53:49,722 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 55 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:49,723 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 55: healthy=True, response_time=0.0
2025-10-21 15:53:49,723 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:49,725 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:53:49,726 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:53:49,727 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:53:49,728 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:53:49,728 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 56 (enabled: 1) ==========
2025-10-21 15:53:49,729 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 56 current status: OK
2025-10-21 15:53:49,729 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 56 <<<<<
2025-10-21 15:53:49,730 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 56 (IP: 127.0.0.1:5556)
2025-10-21 15:53:49,743 - app.services.device_processor - INFO - Checking health for proxy 56 at http://127.0.0.1:5556/Health
2025-10-21 15:53:50,027 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5556/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:50,028 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:50,029 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 56, calling start API
2025-10-21 15:53:50,054 - app.services.device_processor - INFO - Sending start data for proxy 56: {'proxyid': '56', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:50,334 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5556/start "HTTP/1.1 200 OK"
2025-10-21 15:53:50,336 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:50,336 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 56: proxyServiceStart changed to '1'
2025-10-21 15:53:50,338 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 56: {'proxyid': 56, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}}
2025-10-21 15:53:50,338 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:50,340 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:53:50,341 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:53:50,342 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:53:50,343 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 56: network OK
2025-10-21 15:53:50,343 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:53:50,344 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 56 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:50,345 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 56: healthy=True, response_time=0.0
2025-10-21 15:53:50,346 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:50,347 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:53:50,348 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:53:50,349 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:53:50,350 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:53:50,351 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 57 (enabled: 1) ==========
2025-10-21 15:53:50,352 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 57 current status: OK
2025-10-21 15:53:50,352 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 57 <<<<<
2025-10-21 15:53:50,353 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 57 (IP: 127.0.0.1:5557)
2025-10-21 15:53:50,365 - app.services.device_processor - INFO - Checking health for proxy 57 at http://127.0.0.1:5557/Health
2025-10-21 15:53:50,624 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5557/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:50,626 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:50,626 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 57, calling start API
2025-10-21 15:53:50,627 - app.services.device_processor - INFO - Sending start data for proxy 57: {'proxyid': '57', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:50,892 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5557/start "HTTP/1.1 200 OK"
2025-10-21 15:53:50,894 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:50,895 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 57: proxyServiceStart changed to '1'
2025-10-21 15:53:50,896 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 57: {'proxyid': 57, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}}
2025-10-21 15:53:50,897 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:50,899 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:53:50,901 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:53:50,902 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:53:50,903 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:53:50,904 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 57: network OK
2025-10-21 15:53:50,905 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 57 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:50,906 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 57: healthy=True, response_time=0.0
2025-10-21 15:53:50,906 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:50,909 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:53:50,910 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:53:50,911 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:53:50,912 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:53:50,912 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 60 (enabled: 0) ==========
2025-10-21 15:53:50,914 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 60
2025-10-21 15:53:50,914 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 61 (enabled: 0) ==========
2025-10-21 15:53:50,915 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 61
2025-10-21 15:53:50,916 - app.services.background_worker - INFO - [HEALTH_SYNC] Completed health check for 5 devices
2025-10-21 15:53:50,916 - app.services.background_worker - INFO - [BG_WORKER] Background task execution cycle completed
2025-10-21 15:53:51,108 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 15:53:51,109 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 15:53:51,110 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 15:53:51,110 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 15:53:51,111 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 15:53:51,112 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 15:53:51,124 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 15:53:51,478 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5555/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:51,480 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:51,481 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 55, calling start API
2025-10-21 15:53:51,496 - app.services.device_processor - INFO - Sending start data for proxy 55: {'proxyid': '55', 'Controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:51,810 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5555/start "HTTP/1.1 200 OK"
2025-10-21 15:53:51,812 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:51,813 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 55: proxyServiceStart changed to '1'
2025-10-21 15:53:51,815 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 55: {'proxyid': 55, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}}
2025-10-21 15:53:51,816 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:51,819 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:53:51,820 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:53:51,821 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:53:51,822 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:53:51,822 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 55: network OK
2025-10-21 15:53:51,824 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 55 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:51,825 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 55: healthy=True, response_time=0.0
2025-10-21 15:53:51,825 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:51,827 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:53:51,828 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:53:51,830 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:53:51,830 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:53:51,831 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 56 (enabled: 1) ==========
2025-10-21 15:53:51,832 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 56 current status: OK
2025-10-21 15:53:51,832 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 56 <<<<<
2025-10-21 15:53:51,833 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 56 (IP: 127.0.0.1:5556)
2025-10-21 15:53:51,834 - app.services.device_processor - INFO - Checking health for proxy 56 at http://127.0.0.1:5556/Health
2025-10-21 15:53:52,139 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5556/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:52,141 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:52,141 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 56, calling start API
2025-10-21 15:53:52,143 - app.services.device_processor - INFO - Sending start data for proxy 56: {'proxyid': '56', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:52,396 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5556/start "HTTP/1.1 200 OK"
2025-10-21 15:53:52,398 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:52,399 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 56: proxyServiceStart changed to '1'
2025-10-21 15:53:52,400 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 56: {'proxyid': 56, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}}
2025-10-21 15:53:52,400 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:52,402 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:53:52,403 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:53:52,404 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:53:52,404 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:53:52,405 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 56: network OK
2025-10-21 15:53:52,406 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 56 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:52,406 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 56: healthy=True, response_time=0.0
2025-10-21 15:53:52,407 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:52,408 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:53:52,409 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:53:52,410 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:53:52,410 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:53:52,411 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 57 (enabled: 1) ==========
2025-10-21 15:53:52,411 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 57 current status: OK
2025-10-21 15:53:52,412 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 57 <<<<<
2025-10-21 15:53:52,412 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 57 (IP: 127.0.0.1:5557)
2025-10-21 15:53:52,427 - app.services.device_processor - INFO - Checking health for proxy 57 at http://127.0.0.1:5557/Health
2025-10-21 15:53:52,670 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5557/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:52,672 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:52,672 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 57, calling start API
2025-10-21 15:53:52,690 - app.services.device_processor - INFO - Sending start data for proxy 57: {'proxyid': '57', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:52,954 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5557/start "HTTP/1.1 200 OK"
2025-10-21 15:53:52,956 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:52,957 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 57: proxyServiceStart changed to '1'
2025-10-21 15:53:52,958 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 57: {'proxyid': 57, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}}
2025-10-21 15:53:52,958 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:52,960 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:53:52,961 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:53:52,962 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:53:52,963 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:53:52,963 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 57: network OK
2025-10-21 15:53:52,965 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 57 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:52,965 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 57: healthy=True, response_time=0.0
2025-10-21 15:53:52,966 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:52,968 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:53:52,969 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:53:52,970 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:53:52,970 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:53:52,971 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 60 (enabled: 0) ==========
2025-10-21 15:53:52,973 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 60
2025-10-21 15:53:52,973 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 61 (enabled: 0) ==========
2025-10-21 15:53:52,974 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 61
2025-10-21 15:53:52,974 - app.services.background_worker - INFO - [HEALTH_SYNC] Completed health check for 5 devices
2025-10-21 15:53:52,975 - app.services.background_worker - INFO - [BG_WORKER] Background task execution cycle completed
2025-10-21 15:53:53,173 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 15:53:53,174 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 15:53:53,174 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 15:53:53,175 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 15:53:53,176 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 15:53:53,176 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 15:53:53,177 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 15:53:53,447 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5555/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:53,449 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:53,450 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 55, calling start API
2025-10-21 15:53:53,451 - app.services.device_processor - INFO - Sending start data for proxy 55: {'proxyid': '55', 'Controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:53,725 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5555/start "HTTP/1.1 200 OK"
2025-10-21 15:53:53,727 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:53,728 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 55: proxyServiceStart changed to '1'
2025-10-21 15:53:53,729 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 55: {'proxyid': 55, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}}
2025-10-21 15:53:53,730 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:53,731 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:53:53,732 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:53:53,733 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:53:53,734 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:53:53,735 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 55: network OK
2025-10-21 15:53:53,736 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 55 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:53,737 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 55: healthy=True, response_time=0.0
2025-10-21 15:53:53,737 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:53:53,739 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:53:53,740 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:53:53,740 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:53:53,741 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:53:53,741 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 56 (enabled: 1) ==========
2025-10-21 15:53:53,742 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 56 current status: OK
2025-10-21 15:53:53,742 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 56 <<<<<
2025-10-21 15:53:53,743 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 56 (IP: 127.0.0.1:5556)
2025-10-21 15:53:53,744 - app.services.device_processor - INFO - Checking health for proxy 56 at http://127.0.0.1:5556/Health
2025-10-21 15:53:54,007 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5556/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:54,009 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:54,010 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 56, calling start API
2025-10-21 15:53:54,011 - app.services.device_processor - INFO - Sending start data for proxy 56: {'proxyid': '56', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:54,303 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5556/start "HTTP/1.1 200 OK"
2025-10-21 15:53:54,305 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:54,306 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 56: proxyServiceStart changed to '1'
2025-10-21 15:53:54,309 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 56: {'proxyid': 56, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}}
2025-10-21 15:53:54,309 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:54,311 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:53:54,312 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:53:54,313 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:53:54,314 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:53:54,316 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 56: network OK
2025-10-21 15:53:54,317 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 56 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:53:54,318 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 56: healthy=True, response_time=0.0
2025-10-21 15:53:54,319 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:53:54,321 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:53:54,322 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:53:54,323 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:53:54,324 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:53:54,325 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 57 (enabled: 1) ==========
2025-10-21 15:53:54,326 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 57 current status: OK
2025-10-21 15:53:54,326 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 57 <<<<<
2025-10-21 15:53:54,327 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 57 (IP: 127.0.0.1:5557)
2025-10-21 15:53:54,328 - app.services.device_processor - INFO - Checking health for proxy 57 at http://127.0.0.1:5557/Health
2025-10-21 15:53:54,656 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5557/Health "HTTP/1.1 200 OK"
2025-10-21 15:53:54,657 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:54,658 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 57, calling start API
2025-10-21 15:53:54,671 - app.services.device_processor - INFO - Sending start data for proxy 57: {'proxyid': '57', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:53:54,971 - root - INFO - Shutting down Device Service...
2025-10-21 15:53:54,972 - app.services.background_worker - INFO - Background worker stopped
2025-10-21 15:53:54,973 - app.mqtt.client - INFO - [MQTT_CLIENT] 開始斷開MQTT連接 - 客戶端ID: b'device_service_1761033198921_28456'
2025-10-21 15:53:55,335 - app.mqtt.client - WARNING - [MQTT_CLIENT] MQTT客戶端斷開連接 - 錯誤碼: 0, 客戶端ID: b'device_service_1761033198921_28456'
2025-10-21 15:53:55,336 - app.mqtt.client - INFO - [MQTT_CLIENT] MQTT客戶端已斷開連接
2025-10-21 15:53:55,338 - root - INFO - MQTT客戶端已關閉
2025-10-21 15:53:55,340 - root - INFO - Device Service shutdown complete
2025-10-21 15:53:55,345 - app.services.background_worker - INFO - Background worker task cancelled
2025-10-21 15:55:24,145 - root - INFO - Starting Device Service...
2025-10-21 15:55:24,146 - root - INFO - Configuration loaded: HOST=0.0.0.0, PORT=5200
2025-10-21 15:55:24,147 - root - INFO - 啟動MQTT客戶端，連接到 127.0.0.1:2834
2025-10-21 15:55:24,148 - app.mqtt.client - INFO - [MQTT_CLIENT] 開始連接MQTT Broker - 主機: 127.0.0.1:2834, 客戶端ID: device_service_1761033324148_28572
2025-10-21 15:55:24,148 - app.mqtt.client - INFO - [MQTT_CLIENT] 連接MQTT Broker: 127.0.0.1:2834
2025-10-21 15:55:24,152 - app.mqtt.client - INFO - [MQTT_CLIENT] MQTT網路循環已啟動
2025-10-21 15:55:24,154 - app.mqtt.client - INFO - [MQTT_CLIENT] MQTT客戶端連接成功 - 錯誤碼: 0
2025-10-21 15:55:24,657 - app.mqtt.client - INFO - [MQTT_CLIENT] MQTT客戶端連接建立成功 - 重試次數: 1
2025-10-21 15:55:24,659 - root - INFO - MQTT客戶端連接成功
2025-10-21 15:55:24,660 - app.mqtt.client - INFO - [MQTT_CLIENT] 註冊訊息處理器 - Topic: mcs/events/ProxyService/status/+
2025-10-21 15:55:24,660 - app.mqtt.client - INFO - [MQTT_CLIENT] 訂閱主題 - Topic: mcs/events/ProxyService/status/+
2025-10-21 15:55:24,661 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功訂閱主題 - Topic: mcs/events/ProxyService/status/+, 結果碼: 0
2025-10-21 15:55:24,662 - app.mqtt.client - INFO - [MQTT_CLIENT] 註冊訊息處理器 - Topic: mcs/events/DeviceService/status/+
2025-10-21 15:55:24,662 - app.mqtt.client - INFO - [MQTT_CLIENT] 訂閱主題 - Topic: mcs/events/DeviceService/status/+
2025-10-21 15:55:24,663 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功訂閱主題 - Topic: mcs/events/DeviceService/status/+, 結果碼: 0
2025-10-21 15:55:24,664 - app.mqtt.client - INFO - [MQTT_CLIENT] 註冊訊息處理器 - Topic: mcs/events/deviceService/+
2025-10-21 15:55:24,665 - app.mqtt.client - INFO - [MQTT_CLIENT] 訂閱主題 - Topic: mcs/events/deviceService/+
2025-10-21 15:55:24,666 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功訂閱主題 - Topic: mcs/events/deviceService/+, 結果碼: 0
2025-10-21 15:55:24,666 - root - INFO - MQTT訊息監聽已啟動
2025-10-21 15:55:24,670 - root - INFO - Database tables created successfully
2025-10-21 15:55:24,673 - app.services.background_worker - INFO - Background worker started
2025-10-21 15:55:24,674 - root - INFO - Background worker started
2025-10-21 15:55:24,675 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 15:55:24,675 - app.services.background_worker - INFO - [CACHE_LOAD] Loading devices to cache for the first time
2025-10-21 15:55:24,686 - app.services.device_processor - INFO - [CACHE_LOAD] Starting device cache load
2025-10-21 15:55:24,686 - app.services.device_processor - INFO - [CACHE_LOAD] Cache load completed: 5 devices loaded
2025-10-21 15:55:24,687 - app.services.device_processor - INFO - [CACHE_LOAD] Device status cache now contains 3 entries
2025-10-21 15:55:24,687 - app.services.background_worker - INFO - [CACHE_LOAD] Loaded 5 devices to cache (one-time initialization)
2025-10-21 15:55:24,688 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 15:55:24,689 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 15:55:24,690 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 15:55:24,691 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 15:55:24,692 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 15:55:24,693 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 15:55:25,007 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5555/Health "HTTP/1.1 200 OK"
2025-10-21 15:55:25,009 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:55:25,010 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 55, calling start API
2025-10-21 15:55:25,011 - app.services.device_processor - INFO - Sending start data for proxy 55: {'proxyid': '55', 'Controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:55:25,271 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5555/start "HTTP/1.1 200 OK"
2025-10-21 15:55:25,272 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:55:25,273 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 55: proxyServiceStart changed to '1'
2025-10-21 15:55:25,275 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 55: {'proxyid': 55, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}}
2025-10-21 15:55:25,275 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:55:25,278 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:55:25,280 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:55:25,281 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:55:25,282 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:55:25,283 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 55: network OK
2025-10-21 15:55:25,284 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 55 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:55:25,285 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 55: healthy=True, response_time=0.0
2025-10-21 15:55:25,286 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:55:25,288 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:55:25,290 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:55:25,292 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:55:25,293 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:55:25,293 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 56 (enabled: 1) ==========
2025-10-21 15:55:25,294 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 56 current status: OK
2025-10-21 15:55:25,295 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 56 <<<<<
2025-10-21 15:55:25,296 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 56 (IP: 127.0.0.1:5556)
2025-10-21 15:55:25,298 - app.services.device_processor - INFO - Checking health for proxy 56 at http://127.0.0.1:5556/Health
2025-10-21 15:55:25,637 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5556/Health "HTTP/1.1 200 OK"
2025-10-21 15:55:25,639 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:55:25,639 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 56, calling start API
2025-10-21 15:55:25,641 - app.services.device_processor - INFO - Sending start data for proxy 56: {'proxyid': '56', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:55:25,953 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5556/start "HTTP/1.1 200 OK"
2025-10-21 15:55:25,955 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:55:25,956 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 56: proxyServiceStart changed to '1'
2025-10-21 15:55:25,957 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 56: {'proxyid': 56, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}}
2025-10-21 15:55:25,957 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:55:25,959 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:55:25,960 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:55:25,961 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:55:25,962 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:55:25,963 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 56: network OK
2025-10-21 15:55:25,964 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 56 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:55:25,965 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 56: healthy=True, response_time=0.0
2025-10-21 15:55:25,965 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:55:25,968 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:55:25,969 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:55:25,970 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:55:25,971 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:55:25,971 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 57 (enabled: 1) ==========
2025-10-21 15:55:25,972 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 57 current status: OK
2025-10-21 15:55:25,973 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 57 <<<<<
2025-10-21 15:55:25,974 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 57 (IP: 127.0.0.1:5557)
2025-10-21 15:55:25,988 - app.services.device_processor - INFO - Checking health for proxy 57 at http://127.0.0.1:5557/Health
2025-10-21 15:55:26,427 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5557/Health "HTTP/1.1 200 OK"
2025-10-21 15:55:26,430 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:55:26,430 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 57, calling start API
2025-10-21 15:55:26,432 - app.services.device_processor - INFO - Sending start data for proxy 57: {'proxyid': '57', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:55:26,868 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5557/start "HTTP/1.1 200 OK"
2025-10-21 15:55:26,869 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:55:26,870 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 57: proxyServiceStart changed to '1'
2025-10-21 15:55:26,871 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 57: {'proxyid': 57, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}}
2025-10-21 15:55:26,871 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:55:26,874 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:55:26,875 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:55:26,877 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:55:26,878 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:55:26,879 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 57: network OK
2025-10-21 15:55:26,880 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 57 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:55:26,881 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 57: healthy=True, response_time=0.0
2025-10-21 15:55:26,881 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:55:26,884 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:55:26,886 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:55:26,887 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:55:26,887 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:55:26,889 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 60 (enabled: 0) ==========
2025-10-21 15:55:26,889 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 60
2025-10-21 15:55:26,890 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 61 (enabled: 0) ==========
2025-10-21 15:55:26,891 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 61
2025-10-21 15:55:26,891 - app.services.background_worker - INFO - [HEALTH_SYNC] Completed health check for 5 devices
2025-10-21 15:55:26,892 - app.services.background_worker - INFO - [BG_WORKER] Background task execution cycle completed
2025-10-21 15:55:27,082 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 15:55:27,083 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 15:55:27,084 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 15:55:27,084 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 15:55:27,085 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 15:55:27,086 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 15:55:27,098 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 15:55:27,513 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5555/Health "HTTP/1.1 200 OK"
2025-10-21 15:55:27,514 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:55:27,514 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 55, calling start API
2025-10-21 15:55:27,516 - app.services.device_processor - INFO - Sending start data for proxy 55: {'proxyid': '55', 'Controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:55:27,887 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5555/start "HTTP/1.1 200 OK"
2025-10-21 15:55:27,888 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:55:27,889 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 55: proxyServiceStart changed to '1'
2025-10-21 15:55:27,890 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 55: {'proxyid': 55, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}}
2025-10-21 15:55:27,891 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:55:27,893 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:55:27,894 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:55:27,896 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:55:27,897 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:55:27,898 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 55: network OK
2025-10-21 15:55:27,901 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 55 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:55:27,901 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 55: healthy=True, response_time=0.0
2025-10-21 15:55:27,903 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:55:27,906 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:55:27,908 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:55:27,909 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:55:27,911 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:55:27,911 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 56 (enabled: 1) ==========
2025-10-21 15:55:27,912 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 56 current status: OK
2025-10-21 15:55:27,913 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 56 <<<<<
2025-10-21 15:55:27,914 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 56 (IP: 127.0.0.1:5556)
2025-10-21 15:55:27,931 - app.services.device_processor - INFO - Checking health for proxy 56 at http://127.0.0.1:5556/Health
2025-10-21 15:55:28,331 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5556/Health "HTTP/1.1 200 OK"
2025-10-21 15:55:28,333 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:55:28,335 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 56, calling start API
2025-10-21 15:55:28,337 - app.services.device_processor - INFO - Sending start data for proxy 56: {'proxyid': '56', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:55:28,727 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5556/start "HTTP/1.1 200 OK"
2025-10-21 15:55:28,729 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:55:28,729 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 56: proxyServiceStart changed to '1'
2025-10-21 15:55:28,730 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 56: {'proxyid': 56, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}}
2025-10-21 15:55:28,731 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:55:28,734 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:55:28,736 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:55:28,737 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:55:28,738 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:55:28,739 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 56: network OK
2025-10-21 15:55:28,741 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 56 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:55:28,741 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 56: healthy=True, response_time=0.0
2025-10-21 15:55:28,742 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:55:28,745 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:55:28,746 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:55:28,747 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:55:28,748 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:55:28,749 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 57 (enabled: 1) ==========
2025-10-21 15:55:28,750 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 57 current status: OK
2025-10-21 15:55:28,750 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 57 <<<<<
2025-10-21 15:55:28,751 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 57 (IP: 127.0.0.1:5557)
2025-10-21 15:55:28,753 - app.services.device_processor - INFO - Checking health for proxy 57 at http://127.0.0.1:5557/Health
2025-10-21 15:55:29,098 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5557/Health "HTTP/1.1 200 OK"
2025-10-21 15:55:29,099 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:55:29,100 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 57, calling start API
2025-10-21 15:55:29,122 - app.services.device_processor - INFO - Sending start data for proxy 57: {'proxyid': '57', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:55:29,432 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5557/start "HTTP/1.1 200 OK"
2025-10-21 15:55:29,433 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:55:29,434 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 57: proxyServiceStart changed to '1'
2025-10-21 15:55:29,435 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 57: {'proxyid': 57, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}}
2025-10-21 15:55:29,435 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:55:29,437 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:55:29,439 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:55:29,440 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:55:29,440 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:55:29,441 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 57: network OK
2025-10-21 15:55:29,443 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 57 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:55:29,443 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 57: healthy=True, response_time=0.0
2025-10-21 15:55:29,444 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:55:29,446 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:55:29,447 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:55:29,448 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:55:29,448 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:55:29,449 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 60 (enabled: 0) ==========
2025-10-21 15:55:29,450 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 60
2025-10-21 15:55:29,451 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 61 (enabled: 0) ==========
2025-10-21 15:55:29,451 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 61
2025-10-21 15:55:29,452 - app.services.background_worker - INFO - [HEALTH_SYNC] Completed health check for 5 devices
2025-10-21 15:55:29,453 - app.services.background_worker - INFO - [BG_WORKER] Background task execution cycle completed
2025-10-21 15:55:29,638 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 15:55:29,638 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 15:55:29,640 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 15:55:29,640 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 15:55:29,641 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 15:55:29,641 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 15:55:29,653 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 15:55:29,976 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5555/Health "HTTP/1.1 200 OK"
2025-10-21 15:55:29,977 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:55:29,979 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 55, calling start API
2025-10-21 15:55:29,991 - app.services.device_processor - INFO - Sending start data for proxy 55: {'proxyid': '55', 'Controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:55:30,291 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5555/start "HTTP/1.1 200 OK"
2025-10-21 15:55:30,291 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:55:30,292 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 55: proxyServiceStart changed to '1'
2025-10-21 15:55:30,293 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 55: {'proxyid': 55, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}}
2025-10-21 15:55:30,293 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:55:30,294 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:55:30,295 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:55:30,297 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:55:30,297 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:55:30,297 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 55: network OK
2025-10-21 15:55:30,299 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 55 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:55:30,300 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 55: healthy=True, response_time=0.0
2025-10-21 15:55:30,300 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:55:30,303 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:55:30,306 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:55:30,307 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:55:30,308 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:55:30,308 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 56 (enabled: 1) ==========
2025-10-21 15:55:30,309 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 56 current status: OK
2025-10-21 15:55:30,309 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 56 <<<<<
2025-10-21 15:55:30,310 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 56 (IP: 127.0.0.1:5556)
2025-10-21 15:55:30,311 - app.services.device_processor - INFO - Checking health for proxy 56 at http://127.0.0.1:5556/Health
2025-10-21 15:55:30,605 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5556/Health "HTTP/1.1 200 OK"
2025-10-21 15:55:30,606 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:55:30,607 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 56, calling start API
2025-10-21 15:55:30,608 - app.services.device_processor - INFO - Sending start data for proxy 56: {'proxyid': '56', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:55:30,898 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5556/start "HTTP/1.1 200 OK"
2025-10-21 15:55:30,900 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:55:30,901 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 56: proxyServiceStart changed to '1'
2025-10-21 15:55:30,901 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 56: {'proxyid': 56, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}}
2025-10-21 15:55:30,902 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:55:30,904 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:55:30,905 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:55:30,906 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:55:30,907 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:55:30,907 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 56: network OK
2025-10-21 15:55:30,909 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 56 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:55:30,910 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 56: healthy=True, response_time=0.0
2025-10-21 15:55:30,910 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:55:30,912 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:55:30,913 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:55:30,914 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:55:30,914 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:55:30,915 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 57 (enabled: 1) ==========
2025-10-21 15:55:30,916 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 57 current status: OK
2025-10-21 15:55:30,916 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 57 <<<<<
2025-10-21 15:55:30,918 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 57 (IP: 127.0.0.1:5557)
2025-10-21 15:55:30,919 - app.services.device_processor - INFO - Checking health for proxy 57 at http://127.0.0.1:5557/Health
2025-10-21 15:55:31,262 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5557/Health "HTTP/1.1 200 OK"
2025-10-21 15:55:31,263 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:55:31,264 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 57, calling start API
2025-10-21 15:55:31,265 - app.services.device_processor - INFO - Sending start data for proxy 57: {'proxyid': '57', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:55:31,606 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5557/start "HTTP/1.1 200 OK"
2025-10-21 15:55:31,608 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:55:31,608 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 57: proxyServiceStart changed to '1'
2025-10-21 15:55:31,609 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 57: {'proxyid': 57, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}}
2025-10-21 15:55:31,610 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:55:31,612 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:55:31,613 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:55:31,615 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:55:31,616 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:55:31,618 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 57: network OK
2025-10-21 15:55:31,619 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 57 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:55:31,619 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 57: healthy=True, response_time=0.0
2025-10-21 15:55:31,620 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:55:31,622 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:55:31,623 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:55:31,624 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:55:31,625 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:55:31,626 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 60 (enabled: 0) ==========
2025-10-21 15:55:31,626 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 60
2025-10-21 15:55:31,627 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 61 (enabled: 0) ==========
2025-10-21 15:55:31,627 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 61
2025-10-21 15:55:31,628 - app.services.background_worker - INFO - [HEALTH_SYNC] Completed health check for 5 devices
2025-10-21 15:55:31,628 - app.services.background_worker - INFO - [BG_WORKER] Background task execution cycle completed
2025-10-21 15:55:31,831 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 15:55:31,832 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 15:55:31,833 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 15:55:31,834 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 15:55:31,834 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 15:55:31,835 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 15:55:31,836 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 15:55:32,119 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5555/Health "HTTP/1.1 200 OK"
2025-10-21 15:55:32,120 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:55:32,121 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 55, calling start API
2025-10-21 15:55:32,139 - app.services.device_processor - INFO - Sending start data for proxy 55: {'proxyid': '55', 'Controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:55:32,376 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5555/start "HTTP/1.1 200 OK"
2025-10-21 15:55:32,379 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:55:32,379 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 55: proxyServiceStart changed to '1'
2025-10-21 15:55:32,380 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 55: {'proxyid': 55, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}}
2025-10-21 15:55:32,381 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:55:32,382 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:55:32,383 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:55:32,384 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:55:32,386 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:55:32,386 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 55: network OK
2025-10-21 15:55:32,387 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 55 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:55:32,388 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 55: healthy=True, response_time=0.0
2025-10-21 15:55:32,388 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:55:32,390 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:55:32,391 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:55:32,392 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:55:32,392 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:55:32,393 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 56 (enabled: 1) ==========
2025-10-21 15:55:32,394 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 56 current status: OK
2025-10-21 15:55:32,394 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 56 <<<<<
2025-10-21 15:55:32,395 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 56 (IP: 127.0.0.1:5556)
2025-10-21 15:55:32,396 - app.services.device_processor - INFO - Checking health for proxy 56 at http://127.0.0.1:5556/Health
2025-10-21 15:55:32,722 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5556/Health "HTTP/1.1 200 OK"
2025-10-21 15:55:32,725 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:55:32,725 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 56, calling start API
2025-10-21 15:55:32,743 - app.services.device_processor - INFO - Sending start data for proxy 56: {'proxyid': '56', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:55:33,081 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5556/start "HTTP/1.1 200 OK"
2025-10-21 15:55:33,083 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:55:33,084 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 56: proxyServiceStart changed to '1'
2025-10-21 15:55:33,085 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 56: {'proxyid': 56, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}}
2025-10-21 15:55:33,086 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:55:33,087 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:55:33,088 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:55:33,090 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:55:33,091 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:55:33,092 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 56: network OK
2025-10-21 15:55:33,093 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 56 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:55:33,094 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 56: healthy=True, response_time=0.0
2025-10-21 15:55:33,095 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:55:33,097 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:55:33,099 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:55:33,100 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:55:33,100 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:55:33,101 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 57 (enabled: 1) ==========
2025-10-21 15:55:33,102 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 57 current status: OK
2025-10-21 15:55:33,103 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 57 <<<<<
2025-10-21 15:55:33,103 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 57 (IP: 127.0.0.1:5557)
2025-10-21 15:55:33,105 - app.services.device_processor - INFO - Checking health for proxy 57 at http://127.0.0.1:5557/Health
2025-10-21 15:55:33,457 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5557/Health "HTTP/1.1 200 OK"
2025-10-21 15:55:33,458 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:55:33,459 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 57, calling start API
2025-10-21 15:55:33,460 - app.services.device_processor - INFO - Sending start data for proxy 57: {'proxyid': '57', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:55:33,817 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5557/start "HTTP/1.1 200 OK"
2025-10-21 15:55:33,819 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:55:33,819 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 57: proxyServiceStart changed to '1'
2025-10-21 15:55:33,820 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 57: {'proxyid': 57, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}}
2025-10-21 15:55:33,821 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:55:33,822 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:55:33,824 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:55:33,825 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:55:33,826 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:55:33,827 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 57: network OK
2025-10-21 15:55:33,828 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 57 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:55:33,828 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 57: healthy=True, response_time=0.0
2025-10-21 15:55:33,829 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:55:33,836 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:55:33,837 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:55:33,839 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:55:33,840 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:55:33,841 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 60 (enabled: 0) ==========
2025-10-21 15:55:33,841 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 60
2025-10-21 15:55:33,842 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 61 (enabled: 0) ==========
2025-10-21 15:55:33,842 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 61
2025-10-21 15:55:33,843 - app.services.background_worker - INFO - [HEALTH_SYNC] Completed health check for 5 devices
2025-10-21 15:55:33,844 - app.services.background_worker - INFO - [BG_WORKER] Background task execution cycle completed
2025-10-21 15:55:34,031 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 15:55:34,032 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 15:55:34,033 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 15:55:34,033 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 15:55:34,034 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 15:55:34,035 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 15:55:34,046 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 15:55:34,342 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5555/Health "HTTP/1.1 200 OK"
2025-10-21 15:55:34,343 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:55:34,344 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 55, calling start API
2025-10-21 15:55:34,359 - app.services.device_processor - INFO - Sending start data for proxy 55: {'proxyid': '55', 'Controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:55:34,698 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5555/start "HTTP/1.1 200 OK"
2025-10-21 15:55:34,700 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:55:34,702 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 55: proxyServiceStart changed to '1'
2025-10-21 15:55:34,703 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 55: {'proxyid': 55, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}}
2025-10-21 15:55:34,703 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:55:34,704 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:55:34,706 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:55:34,707 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:55:34,708 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:55:34,708 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 55: network OK
2025-10-21 15:55:34,710 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 55 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:55:34,710 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 55: healthy=True, response_time=0.0
2025-10-21 15:55:34,711 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:55:34,712 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:55:34,714 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:55:34,715 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:55:34,716 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:55:34,717 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 56 (enabled: 1) ==========
2025-10-21 15:55:34,718 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 56 current status: OK
2025-10-21 15:55:34,718 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 56 <<<<<
2025-10-21 15:55:34,720 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 56 (IP: 127.0.0.1:5556)
2025-10-21 15:55:34,721 - app.services.device_processor - INFO - Checking health for proxy 56 at http://127.0.0.1:5556/Health
2025-10-21 15:55:35,071 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5556/Health "HTTP/1.1 200 OK"
2025-10-21 15:55:35,073 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:55:35,073 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 56, calling start API
2025-10-21 15:55:35,075 - app.services.device_processor - INFO - Sending start data for proxy 56: {'proxyid': '56', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:55:35,429 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5556/start "HTTP/1.1 200 OK"
2025-10-21 15:55:35,432 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:55:35,432 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 56: proxyServiceStart changed to '1'
2025-10-21 15:55:35,434 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 56: {'proxyid': 56, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}}
2025-10-21 15:55:35,435 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:55:35,438 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:55:35,439 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:55:35,440 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:55:35,441 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:55:35,442 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 56: network OK
2025-10-21 15:55:35,443 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 56 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:55:35,444 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 56: healthy=True, response_time=0.0
2025-10-21 15:55:35,445 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:55:35,447 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:55:35,449 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:55:35,450 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:55:35,451 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:55:35,452 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 57 (enabled: 1) ==========
2025-10-21 15:55:35,453 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 57 current status: OK
2025-10-21 15:55:35,454 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 57 <<<<<
2025-10-21 15:55:35,455 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 57 (IP: 127.0.0.1:5557)
2025-10-21 15:55:35,457 - app.services.device_processor - INFO - Checking health for proxy 57 at http://127.0.0.1:5557/Health
2025-10-21 15:55:35,817 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5557/Health "HTTP/1.1 200 OK"
2025-10-21 15:55:35,819 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:55:35,819 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 57, calling start API
2025-10-21 15:55:35,820 - app.services.device_processor - INFO - Sending start data for proxy 57: {'proxyid': '57', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:55:36,090 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5557/start "HTTP/1.1 200 OK"
2025-10-21 15:55:36,092 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:55:36,094 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 57: proxyServiceStart changed to '1'
2025-10-21 15:55:36,094 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 57: {'proxyid': 57, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}}
2025-10-21 15:55:36,094 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:55:36,097 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:55:36,098 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:55:36,098 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:55:36,099 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:55:36,100 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 57: network OK
2025-10-21 15:55:36,101 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 57 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:55:36,102 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 57: healthy=True, response_time=0.0
2025-10-21 15:55:36,102 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:55:36,103 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:55:36,105 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:55:36,106 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:55:36,106 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:55:36,107 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 60 (enabled: 0) ==========
2025-10-21 15:55:36,108 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 60
2025-10-21 15:55:36,108 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 61 (enabled: 0) ==========
2025-10-21 15:55:36,109 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 61
2025-10-21 15:55:36,109 - app.services.background_worker - INFO - [HEALTH_SYNC] Completed health check for 5 devices
2025-10-21 15:55:36,110 - app.services.background_worker - INFO - [BG_WORKER] Background task execution cycle completed
2025-10-21 15:55:36,292 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 15:55:36,293 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 15:55:36,294 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 15:55:36,294 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 15:55:36,295 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 15:55:36,295 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 15:55:36,296 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 15:55:36,618 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5555/Health "HTTP/1.1 200 OK"
2025-10-21 15:55:36,619 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:55:36,620 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 55, calling start API
2025-10-21 15:55:36,621 - app.services.device_processor - INFO - Sending start data for proxy 55: {'proxyid': '55', 'Controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:55:36,963 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5555/start "HTTP/1.1 200 OK"
2025-10-21 15:55:36,966 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:55:36,967 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 55: proxyServiceStart changed to '1'
2025-10-21 15:55:36,968 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 55: {'proxyid': 55, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}}
2025-10-21 15:55:36,968 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:55:36,971 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:55:36,972 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:55:36,974 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:55:36,976 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:55:36,976 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 55: network OK
2025-10-21 15:55:36,978 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 55 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:55:36,978 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 55: healthy=True, response_time=0.0
2025-10-21 15:55:36,979 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:55:36,981 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:55:36,982 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:55:36,984 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:55:36,985 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:55:36,986 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 56 (enabled: 1) ==========
2025-10-21 15:55:36,987 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 56 current status: OK
2025-10-21 15:55:36,988 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 56 <<<<<
2025-10-21 15:55:36,989 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 56 (IP: 127.0.0.1:5556)
2025-10-21 15:55:36,990 - app.services.device_processor - INFO - Checking health for proxy 56 at http://127.0.0.1:5556/Health
2025-10-21 15:55:37,363 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5556/Health "HTTP/1.1 200 OK"
2025-10-21 15:55:37,366 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:55:37,366 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 56, calling start API
2025-10-21 15:55:37,368 - app.services.device_processor - INFO - Sending start data for proxy 56: {'proxyid': '56', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:55:37,657 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5556/start "HTTP/1.1 200 OK"
2025-10-21 15:55:37,659 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:55:37,660 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 56: proxyServiceStart changed to '1'
2025-10-21 15:55:37,661 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 56: {'proxyid': 56, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}}
2025-10-21 15:55:37,662 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:55:37,664 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:55:37,665 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:55:37,666 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:55:37,667 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:55:37,667 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 56: network OK
2025-10-21 15:55:37,669 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 56 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:55:37,669 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 56: healthy=True, response_time=0.0
2025-10-21 15:55:37,670 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:55:37,672 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:55:37,673 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:55:37,674 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:55:37,676 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:55:37,678 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 57 (enabled: 1) ==========
2025-10-21 15:55:37,680 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 57 current status: OK
2025-10-21 15:55:37,681 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 57 <<<<<
2025-10-21 15:55:37,682 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 57 (IP: 127.0.0.1:5557)
2025-10-21 15:55:37,703 - app.services.device_processor - INFO - Checking health for proxy 57 at http://127.0.0.1:5557/Health
2025-10-21 15:55:38,085 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5557/Health "HTTP/1.1 200 OK"
2025-10-21 15:55:38,086 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:55:38,087 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 57, calling start API
2025-10-21 15:55:38,088 - app.services.device_processor - INFO - Sending start data for proxy 57: {'proxyid': '57', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:55:57,695 - app.services.device_processor - ERROR - Error starting proxy service 57: 
2025-10-21 15:55:57,697 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 57: {'proxyid': 57, 'status': 'error', 'message': ''}
2025-10-21 15:55:57,698 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:55:57,699 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:55:57,701 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:55:57,702 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:55:57,702 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:55:57,703 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 57: network OK
2025-10-21 15:55:57,704 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 57 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:55:57,705 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 57: healthy=True, response_time=0.0
2025-10-21 15:55:57,706 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:55:57,707 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:55:57,709 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:55:57,710 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:55:57,711 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:55:57,711 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 60 (enabled: 0) ==========
2025-10-21 15:55:57,712 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 60
2025-10-21 15:55:57,712 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 61 (enabled: 0) ==========
2025-10-21 15:55:57,713 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 61
2025-10-21 15:55:57,713 - app.services.background_worker - INFO - [HEALTH_SYNC] Completed health check for 5 devices
2025-10-21 15:55:57,714 - app.services.background_worker - INFO - [BG_WORKER] Background task execution cycle completed
2025-10-21 15:55:57,924 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 15:55:57,925 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 15:55:57,925 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 15:55:57,926 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 15:55:57,926 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 15:55:57,927 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 15:55:57,928 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 15:55:58,206 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5555/Health "HTTP/1.1 200 OK"
2025-10-21 15:55:58,208 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:55:58,208 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 55, calling start API
2025-10-21 15:55:58,210 - app.services.device_processor - INFO - Sending start data for proxy 55: {'proxyid': '55', 'Controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:55:58,497 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5555/start "HTTP/1.1 200 OK"
2025-10-21 15:55:58,498 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:55:58,499 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 55: proxyServiceStart changed to '1'
2025-10-21 15:55:58,501 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 55: {'proxyid': 55, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}}
2025-10-21 15:55:58,501 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:55:58,502 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:55:58,504 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:55:58,505 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:55:58,506 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:55:58,507 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 55: network OK
2025-10-21 15:55:58,508 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 55 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:55:58,509 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 55: healthy=True, response_time=0.0
2025-10-21 15:55:58,509 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:55:58,511 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:55:58,512 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:55:58,514 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:55:58,514 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:55:58,515 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 56 (enabled: 1) ==========
2025-10-21 15:55:58,516 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 56 current status: OK
2025-10-21 15:55:58,516 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 56 <<<<<
2025-10-21 15:55:58,517 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 56 (IP: 127.0.0.1:5556)
2025-10-21 15:55:58,518 - app.services.device_processor - INFO - Checking health for proxy 56 at http://127.0.0.1:5556/Health
2025-10-21 15:55:58,801 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5556/Health "HTTP/1.1 200 OK"
2025-10-21 15:55:58,804 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:55:58,804 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 56, calling start API
2025-10-21 15:55:58,805 - app.services.device_processor - INFO - Sending start data for proxy 56: {'proxyid': '56', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:55:59,080 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5556/start "HTTP/1.1 200 OK"
2025-10-21 15:55:59,086 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:55:59,086 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 56: proxyServiceStart changed to '1'
2025-10-21 15:55:59,088 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 56: {'proxyid': 56, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}}
2025-10-21 15:55:59,088 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:55:59,090 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:55:59,092 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:55:59,093 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:55:59,093 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:55:59,095 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 56: network OK
2025-10-21 15:55:59,096 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 56 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:55:59,097 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 56: healthy=True, response_time=0.0
2025-10-21 15:55:59,097 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:55:59,099 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:55:59,100 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:55:59,101 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:55:59,102 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:55:59,103 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 57 (enabled: 1) ==========
2025-10-21 15:55:59,103 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 57 current status: OK
2025-10-21 15:55:59,105 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 57 <<<<<
2025-10-21 15:55:59,106 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 57 (IP: 127.0.0.1:5557)
2025-10-21 15:55:59,107 - app.services.device_processor - INFO - Checking health for proxy 57 at http://127.0.0.1:5557/Health
2025-10-21 15:55:59,394 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5557/Health "HTTP/1.1 200 OK"
2025-10-21 15:55:59,396 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:55:59,396 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 57, calling start API
2025-10-21 15:55:59,398 - app.services.device_processor - INFO - Sending start data for proxy 57: {'proxyid': '57', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:55:59,664 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5557/start "HTTP/1.1 200 OK"
2025-10-21 15:55:59,666 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:55:59,667 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 57: proxyServiceStart changed to '1'
2025-10-21 15:55:59,667 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 57: {'proxyid': 57, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}}
2025-10-21 15:55:59,668 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:55:59,669 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:55:59,670 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:55:59,672 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:55:59,673 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:55:59,673 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 57: network OK
2025-10-21 15:55:59,675 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 57 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:55:59,675 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 57: healthy=True, response_time=0.0
2025-10-21 15:55:59,676 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:55:59,678 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:55:59,679 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:55:59,680 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:55:59,680 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:55:59,681 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 60 (enabled: 0) ==========
2025-10-21 15:55:59,682 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 60
2025-10-21 15:55:59,682 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 61 (enabled: 0) ==========
2025-10-21 15:55:59,683 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 61
2025-10-21 15:55:59,683 - app.services.background_worker - INFO - [HEALTH_SYNC] Completed health check for 5 devices
2025-10-21 15:55:59,684 - app.services.background_worker - INFO - [BG_WORKER] Background task execution cycle completed
2025-10-21 15:55:59,870 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 15:55:59,870 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 15:55:59,872 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 15:55:59,875 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 15:55:59,875 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 15:55:59,877 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 15:55:59,878 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 15:56:00,163 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5555/Health "HTTP/1.1 200 OK"
2025-10-21 15:56:00,165 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:56:00,166 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 55, calling start API
2025-10-21 15:56:00,167 - app.services.device_processor - INFO - Sending start data for proxy 55: {'proxyid': '55', 'Controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:56:00,454 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5555/start "HTTP/1.1 200 OK"
2025-10-21 15:56:00,456 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:56:00,456 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 55: proxyServiceStart changed to '1'
2025-10-21 15:56:00,457 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 55: {'proxyid': 55, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}}
2025-10-21 15:56:00,458 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:56:00,460 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:56:00,462 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:56:00,462 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:56:00,464 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:56:00,464 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 55: network OK
2025-10-21 15:56:00,466 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 55 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:56:00,466 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 55: healthy=True, response_time=0.0
2025-10-21 15:56:00,467 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:56:00,468 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:56:00,470 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:56:00,471 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:56:00,471 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:56:00,472 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 56 (enabled: 1) ==========
2025-10-21 15:56:00,473 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 56 current status: OK
2025-10-21 15:56:00,473 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 56 <<<<<
2025-10-21 15:56:00,473 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 56 (IP: 127.0.0.1:5556)
2025-10-21 15:56:00,486 - app.services.device_processor - INFO - Checking health for proxy 56 at http://127.0.0.1:5556/Health
2025-10-21 15:56:00,736 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5556/Health "HTTP/1.1 200 OK"
2025-10-21 15:56:00,737 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:56:00,738 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 56, calling start API
2025-10-21 15:56:00,739 - app.services.device_processor - INFO - Sending start data for proxy 56: {'proxyid': '56', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:56:00,998 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5556/start "HTTP/1.1 200 OK"
2025-10-21 15:56:01,000 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:56:01,001 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 56: proxyServiceStart changed to '1'
2025-10-21 15:56:01,002 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 56: {'proxyid': 56, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}}
2025-10-21 15:56:01,003 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:56:01,004 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:56:01,006 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:56:01,007 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:56:01,008 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:56:01,008 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 56: network OK
2025-10-21 15:56:01,010 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 56 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:56:01,011 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 56: healthy=True, response_time=0.0
2025-10-21 15:56:01,011 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:56:01,013 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:56:01,014 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:56:01,016 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:56:01,016 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:56:01,017 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 57 (enabled: 1) ==========
2025-10-21 15:56:01,018 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 57 current status: OK
2025-10-21 15:56:01,018 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 57 <<<<<
2025-10-21 15:56:01,019 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 57 (IP: 127.0.0.1:5557)
2025-10-21 15:56:01,020 - app.services.device_processor - INFO - Checking health for proxy 57 at http://127.0.0.1:5557/Health
2025-10-21 15:56:01,304 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5557/Health "HTTP/1.1 200 OK"
2025-10-21 15:56:01,307 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:56:01,307 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 57, calling start API
2025-10-21 15:56:01,325 - app.services.device_processor - INFO - Sending start data for proxy 57: {'proxyid': '57', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:56:01,629 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5557/start "HTTP/1.1 200 OK"
2025-10-21 15:56:01,631 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:56:01,631 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 57: proxyServiceStart changed to '1'
2025-10-21 15:56:01,633 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 57: {'proxyid': 57, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}}
2025-10-21 15:56:01,633 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:56:01,635 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:56:01,637 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:56:01,637 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:56:01,638 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:56:01,639 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 57: network OK
2025-10-21 15:56:01,641 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 57 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:56:01,641 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 57: healthy=True, response_time=0.0
2025-10-21 15:56:01,642 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:56:01,644 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:56:01,645 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:56:01,646 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:56:01,646 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:56:01,647 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 60 (enabled: 0) ==========
2025-10-21 15:56:01,648 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 60
2025-10-21 15:56:01,649 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 61 (enabled: 0) ==========
2025-10-21 15:56:01,649 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 61
2025-10-21 15:56:01,650 - app.services.background_worker - INFO - [HEALTH_SYNC] Completed health check for 5 devices
2025-10-21 15:56:01,650 - app.services.background_worker - INFO - [BG_WORKER] Background task execution cycle completed
2025-10-21 15:56:01,839 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 15:56:01,839 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 15:56:01,840 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 15:56:01,840 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 15:56:01,841 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 15:56:01,842 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 15:56:01,843 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 15:56:02,112 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5555/Health "HTTP/1.1 200 OK"
2025-10-21 15:56:02,114 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:56:02,115 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 55, calling start API
2025-10-21 15:56:02,116 - app.services.device_processor - INFO - Sending start data for proxy 55: {'proxyid': '55', 'Controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:56:02,368 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5555/start "HTTP/1.1 200 OK"
2025-10-21 15:56:02,369 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:56:02,370 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 55: proxyServiceStart changed to '1'
2025-10-21 15:56:02,371 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 55: {'proxyid': 55, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}}
2025-10-21 15:56:02,372 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:56:02,373 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:56:02,374 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:56:02,376 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:56:02,377 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:56:02,377 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 55: network OK
2025-10-21 15:56:02,378 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 55 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:56:02,379 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 55: healthy=True, response_time=0.0
2025-10-21 15:56:02,379 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:56:02,381 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:56:02,383 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:56:02,384 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:56:02,384 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:56:02,386 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 56 (enabled: 1) ==========
2025-10-21 15:56:02,386 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 56 current status: OK
2025-10-21 15:56:02,387 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 56 <<<<<
2025-10-21 15:56:02,387 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 56 (IP: 127.0.0.1:5556)
2025-10-21 15:56:02,412 - app.services.device_processor - INFO - Checking health for proxy 56 at http://127.0.0.1:5556/Health
2025-10-21 15:56:02,680 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5556/Health "HTTP/1.1 200 OK"
2025-10-21 15:56:02,682 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:56:02,683 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 56, calling start API
2025-10-21 15:56:02,684 - app.services.device_processor - INFO - Sending start data for proxy 56: {'proxyid': '56', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:56:02,973 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5556/start "HTTP/1.1 200 OK"
2025-10-21 15:56:02,976 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:56:02,976 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 56: proxyServiceStart changed to '1'
2025-10-21 15:56:02,977 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 56: {'proxyid': 56, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}}
2025-10-21 15:56:02,978 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:56:02,979 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:56:02,981 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:56:02,983 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:56:02,983 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:56:02,984 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 56: network OK
2025-10-21 15:56:02,986 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 56 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:56:02,986 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 56: healthy=True, response_time=0.0
2025-10-21 15:56:02,987 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:56:02,989 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:56:02,991 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:56:02,992 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:56:02,992 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:56:02,993 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 57 (enabled: 1) ==========
2025-10-21 15:56:02,994 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 57 current status: OK
2025-10-21 15:56:02,995 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 57 <<<<<
2025-10-21 15:56:02,995 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 57 (IP: 127.0.0.1:5557)
2025-10-21 15:56:02,997 - app.services.device_processor - INFO - Checking health for proxy 57 at http://127.0.0.1:5557/Health
2025-10-21 15:56:03,279 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5557/Health "HTTP/1.1 200 OK"
2025-10-21 15:56:03,281 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:56:03,281 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 57, calling start API
2025-10-21 15:56:03,283 - app.services.device_processor - INFO - Sending start data for proxy 57: {'proxyid': '57', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:56:03,554 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5557/start "HTTP/1.1 200 OK"
2025-10-21 15:56:03,556 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:56:03,556 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 57: proxyServiceStart changed to '1'
2025-10-21 15:56:03,557 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 57: {'proxyid': 57, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}}
2025-10-21 15:56:03,558 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:56:03,559 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:56:03,560 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:56:03,561 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:56:03,562 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:56:03,563 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 57: network OK
2025-10-21 15:56:03,564 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 57 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:56:03,565 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 57: healthy=True, response_time=0.0
2025-10-21 15:56:03,565 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:56:03,567 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:56:03,568 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:56:03,569 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:56:03,570 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:56:03,570 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 60 (enabled: 0) ==========
2025-10-21 15:56:03,571 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 60
2025-10-21 15:56:03,572 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 61 (enabled: 0) ==========
2025-10-21 15:56:03,572 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 61
2025-10-21 15:56:03,573 - app.services.background_worker - INFO - [HEALTH_SYNC] Completed health check for 5 devices
2025-10-21 15:56:03,574 - app.services.background_worker - INFO - [BG_WORKER] Background task execution cycle completed
2025-10-21 15:56:03,768 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 15:56:03,769 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 15:56:03,770 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 15:56:03,770 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 15:56:03,771 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 15:56:03,772 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 15:56:03,773 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 15:56:04,034 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5555/Health "HTTP/1.1 200 OK"
2025-10-21 15:56:04,035 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:56:04,036 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 55, calling start API
2025-10-21 15:56:04,062 - app.services.device_processor - INFO - Sending start data for proxy 55: {'proxyid': '55', 'Controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:56:04,373 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5555/start "HTTP/1.1 200 OK"
2025-10-21 15:56:04,375 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:56:04,376 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 55: proxyServiceStart changed to '1'
2025-10-21 15:56:04,377 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 55: {'proxyid': 55, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}}
2025-10-21 15:56:04,378 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:56:04,380 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:56:04,382 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:56:04,385 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:56:04,386 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:56:04,388 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 55: network OK
2025-10-21 15:56:04,390 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 55 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:56:04,391 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 55: healthy=True, response_time=0.0
2025-10-21 15:56:04,392 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:56:04,394 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:56:04,396 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:56:04,398 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:56:04,398 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:56:04,400 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 56 (enabled: 1) ==========
2025-10-21 15:56:04,402 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 56 current status: OK
2025-10-21 15:56:04,403 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 56 <<<<<
2025-10-21 15:56:04,403 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 56 (IP: 127.0.0.1:5556)
2025-10-21 15:56:04,406 - app.services.device_processor - INFO - Checking health for proxy 56 at http://127.0.0.1:5556/Health
2025-10-21 15:56:04,774 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5556/Health "HTTP/1.1 200 OK"
2025-10-21 15:56:04,776 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:56:04,776 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 56, calling start API
2025-10-21 15:56:04,787 - app.services.device_processor - INFO - Sending start data for proxy 56: {'proxyid': '56', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:56:05,103 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5556/start "HTTP/1.1 200 OK"
2025-10-21 15:56:05,109 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:56:05,110 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 56: proxyServiceStart changed to '1'
2025-10-21 15:56:05,111 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 56: {'proxyid': 56, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}}
2025-10-21 15:56:05,112 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:56:05,114 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:56:05,116 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:56:05,117 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:56:05,117 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:56:05,117 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 56: network OK
2025-10-21 15:56:05,120 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 56 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:56:05,121 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 56: healthy=True, response_time=0.0
2025-10-21 15:56:05,121 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 15:56:05,123 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 15:56:05,125 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 15:56:05,125 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 15:56:05,126 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 15:56:05,127 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 57 (enabled: 1) ==========
2025-10-21 15:56:05,127 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 57 current status: OK
2025-10-21 15:56:05,128 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 57 <<<<<
2025-10-21 15:56:05,129 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 57 (IP: 127.0.0.1:5557)
2025-10-21 15:56:05,143 - app.services.device_processor - INFO - Checking health for proxy 57 at http://127.0.0.1:5557/Health
2025-10-21 15:56:05,481 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5557/Health "HTTP/1.1 200 OK"
2025-10-21 15:56:05,482 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:56:05,483 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 57, calling start API
2025-10-21 15:56:05,485 - app.services.device_processor - INFO - Sending start data for proxy 57: {'proxyid': '57', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:56:05,848 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5557/start "HTTP/1.1 200 OK"
2025-10-21 15:56:05,850 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:56:05,850 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 57: proxyServiceStart changed to '1'
2025-10-21 15:56:05,851 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 57: {'proxyid': 57, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}}
2025-10-21 15:56:05,851 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:56:05,854 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:56:05,856 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:56:05,857 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:56:05,858 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:56:05,859 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 57: network OK
2025-10-21 15:56:05,860 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 57 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:56:05,861 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 57: healthy=True, response_time=0.0
2025-10-21 15:56:05,861 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 15:56:05,863 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 15:56:05,864 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 15:56:05,866 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 15:56:05,866 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 15:56:05,867 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 60 (enabled: 0) ==========
2025-10-21 15:56:05,868 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 60
2025-10-21 15:56:05,869 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 61 (enabled: 0) ==========
2025-10-21 15:56:05,869 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 61
2025-10-21 15:56:05,870 - app.services.background_worker - INFO - [HEALTH_SYNC] Completed health check for 5 devices
2025-10-21 15:56:05,871 - app.services.background_worker - INFO - [BG_WORKER] Background task execution cycle completed
2025-10-21 15:56:06,086 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 15:56:06,087 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 15:56:06,088 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 15:56:06,089 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 15:56:06,089 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 15:56:06,090 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 15:56:06,091 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 15:56:06,463 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5555/Health "HTTP/1.1 200 OK"
2025-10-21 15:56:06,464 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:56:06,465 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 55, calling start API
2025-10-21 15:56:06,467 - app.services.device_processor - INFO - Sending start data for proxy 55: {'proxyid': '55', 'Controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:56:16,990 - app.services.device_manager - INFO - Getting proxy status for proxyid: None
2025-10-21 15:56:16,991 - app.services.device_manager - INFO - All device status from cache: {55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}, 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}, 57: {'message': 'OK', 'proxyid': 57, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}}
2025-10-21 15:56:16,992 - app.services.device_manager - INFO - Returning status list with 3 items
2025-10-21 15:56:33,788 - app.services.device_processor - ERROR - Error starting proxy service 55: 
2025-10-21 15:56:33,790 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 55: {'proxyid': 55, 'status': 'error', 'message': ''}
2025-10-21 15:56:33,790 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:56:33,792 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:56:33,794 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:56:33,795 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:56:33,796 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:56:33,797 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 55: network OK
2025-10-21 15:56:33,810 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 55 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 15:56:33,810 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 55: healthy=True, response_time=0.0
2025-10-21 15:56:33,811 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 15:56:33,813 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 15:56:33,814 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 15:56:33,815 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 15:56:33,816 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 15:56:33,817 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 56 (enabled: 1) ==========
2025-10-21 15:56:33,818 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 56 current status: OK
2025-10-21 15:56:33,818 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 56 <<<<<
2025-10-21 15:56:33,819 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 56 (IP: 127.0.0.1:5556)
2025-10-21 15:56:33,820 - app.services.device_processor - INFO - Checking health for proxy 56 at http://127.0.0.1:5556/Health
2025-10-21 15:56:34,127 - app.services.background_worker - INFO - Background worker task cancelled
2025-10-21 15:56:38,358 - root - INFO - Shutting down Device Service...
2025-10-21 15:56:38,359 - app.services.background_worker - INFO - Background worker stopped
2025-10-21 15:56:38,360 - app.mqtt.client - INFO - [MQTT_CLIENT] 開始斷開MQTT連接 - 客戶端ID: b'device_service_1761033324148_28572'
2025-10-21 15:56:38,870 - app.mqtt.client - WARNING - [MQTT_CLIENT] MQTT客戶端斷開連接 - 錯誤碼: 0, 客戶端ID: b'device_service_1761033324148_28572'
2025-10-21 15:56:38,871 - app.mqtt.client - INFO - [MQTT_CLIENT] MQTT客戶端已斷開連接
2025-10-21 15:56:38,872 - root - INFO - MQTT客戶端已關閉
2025-10-21 15:56:38,873 - root - INFO - Device Service shutdown complete
