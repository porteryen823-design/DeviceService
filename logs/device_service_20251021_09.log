2025-10-21 09:39:11,033 - root - INFO - Starting Device Service...
2025-10-21 09:39:11,034 - root - INFO - Configuration loaded: HOST=0.0.0.0, PORT=5200
2025-10-21 09:39:11,034 - root - INFO - 啟動MQTT客戶端，連接到 127.0.0.1:2834
2025-10-21 09:39:11,034 - app.mqtt.client - INFO - [MQTT_CLIENT] 開始連接MQTT Broker - 主機: 127.0.0.1:2834, 客戶端ID: device_service
2025-10-21 09:39:11,035 - app.mqtt.client - INFO - [MQTT_CLIENT] 連接MQTT Broker: 127.0.0.1:2834
2025-10-21 09:39:11,039 - app.mqtt.client - INFO - [MQTT_CLIENT] MQTT網路循環已啟動
2025-10-21 09:39:11,040 - app.mqtt.client - INFO - [MQTT_CLIENT] MQTT客戶端連接成功 - 錯誤碼: 0
2025-10-21 09:39:11,550 - app.mqtt.client - INFO - [MQTT_CLIENT] MQTT客戶端連接建立成功 - 重試次數: 1
2025-10-21 09:39:11,554 - root - INFO - MQTT客戶端連接成功
2025-10-21 09:39:11,554 - app.mqtt.client - INFO - [MQTT_CLIENT] 註冊訊息處理器 - Topic: mcs/events/ProxyService/status/+
2025-10-21 09:39:11,554 - app.mqtt.client - INFO - [MQTT_CLIENT] 訂閱主題 - Topic: mcs/events/ProxyService/status/+
2025-10-21 09:39:11,556 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功訂閱主題 - Topic: mcs/events/ProxyService/status/+, 結果碼: 0
2025-10-21 09:39:11,556 - app.mqtt.client - INFO - [MQTT_CLIENT] 註冊訊息處理器 - Topic: mcs/events/DeviceService/status/+
2025-10-21 09:39:11,557 - app.mqtt.client - INFO - [MQTT_CLIENT] 訂閱主題 - Topic: mcs/events/DeviceService/status/+
2025-10-21 09:39:11,557 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功訂閱主題 - Topic: mcs/events/DeviceService/status/+, 結果碼: 0
2025-10-21 09:39:11,557 - app.mqtt.client - INFO - [MQTT_CLIENT] 註冊訊息處理器 - Topic: mcs/events/deviceService/+
2025-10-21 09:39:11,558 - app.mqtt.client - INFO - [MQTT_CLIENT] 訂閱主題 - Topic: mcs/events/deviceService/+
2025-10-21 09:39:11,558 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功訂閱主題 - Topic: mcs/events/deviceService/+, 結果碼: 0
2025-10-21 09:39:11,559 - root - INFO - MQTT訊息監聽已啟動
2025-10-21 09:39:11,561 - root - INFO - Database tables created successfully
2025-10-21 09:39:11,562 - app.services.background_worker - INFO - Background worker started
2025-10-21 09:39:11,562 - root - INFO - Background worker started
2025-10-21 09:39:11,562 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 09:39:11,562 - app.services.background_worker - INFO - [CACHE_LOAD] Loading devices to cache for the first time
2025-10-21 09:39:11,566 - app.services.device_processor - INFO - [CACHE_LOAD] Starting device cache load
2025-10-21 09:39:11,567 - app.services.device_processor - INFO - [CACHE_LOAD] Cache load completed: 4 devices loaded
2025-10-21 09:39:11,567 - app.services.device_processor - INFO - [CACHE_LOAD] Device status cache now contains 3 entries
2025-10-21 09:39:11,568 - app.services.background_worker - INFO - [CACHE_LOAD] Loaded 4 devices to cache (one-time initialization)
2025-10-21 09:39:11,568 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 09:39:11,569 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 09:39:11,569 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 09:39:11,569 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 09:39:11,570 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 09:39:11,570 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 09:39:11,852 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5555/Health "HTTP/1.1 200 OK"
2025-10-21 09:39:11,853 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:11,853 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 55, calling start API
2025-10-21 09:39:11,854 - app.services.device_processor - INFO - Sending start data for proxy 55: {'proxyid': '55', 'Controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:12,113 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5555/start "HTTP/1.1 200 OK"
2025-10-21 09:39:12,114 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:12,114 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 55: proxyServiceStart changed to '1'
2025-10-21 09:39:12,115 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 55: {'proxyid': 55, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}}
2025-10-21 09:39:12,116 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:12,116 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 09:39:12,116 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 09:39:12,117 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 09:39:12,117 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 55: network OK
2025-10-21 09:39:12,117 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 55 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 09:39:12,118 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 55: healthy=True, response_time=0.0
2025-10-21 09:39:12,118 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 09:39:12,119 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:12,119 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 09:39:12,120 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 09:39:12,120 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 09:39:12,121 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 56 (enabled: 1) ==========
2025-10-21 09:39:12,121 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 09:39:12,121 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 56 current status: OK
2025-10-21 09:39:12,122 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 56 <<<<<
2025-10-21 09:39:12,122 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 56 (IP: 127.0.0.1:5556)
2025-10-21 09:39:12,123 - app.services.device_processor - INFO - Checking health for proxy 56 at http://127.0.0.1:5556/Health
2025-10-21 09:39:12,382 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5556/Health "HTTP/1.1 200 OK"
2025-10-21 09:39:12,383 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:12,383 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 56, calling start API
2025-10-21 09:39:12,384 - app.services.device_processor - INFO - Sending start data for proxy 56: {'proxyid': '56', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:12,633 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5556/start "HTTP/1.1 200 OK"
2025-10-21 09:39:12,634 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:12,634 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 56: proxyServiceStart changed to '1'
2025-10-21 09:39:12,635 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 56: {'proxyid': 56, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}}
2025-10-21 09:39:12,635 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:12,635 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 09:39:12,637 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 09:39:12,637 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 09:39:12,637 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 56: network OK
2025-10-21 09:39:12,638 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 56 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 09:39:12,638 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 09:39:12,639 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 56: healthy=True, response_time=0.0
2025-10-21 09:39:12,639 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:12,640 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 09:39:12,641 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 09:39:12,641 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 09:39:12,642 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 57 (enabled: 1) ==========
2025-10-21 09:39:12,642 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 09:39:12,642 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 57 current status: OK
2025-10-21 09:39:12,643 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 57 <<<<<
2025-10-21 09:39:12,643 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 57 (IP: 127.0.0.1:5557)
2025-10-21 09:39:12,859 - app.services.device_processor - ERROR - [HEALTH_CHECK] Port 5557 on 127.0.0.1 is not accessible for proxy 57
2025-10-21 09:39:12,860 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 57 health check result: proxyServiceStart=0, healthy=False, message=proxy Port not accessible
2025-10-21 09:39:12,860 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 57: healthy=False, response_time=0.0
2025-10-21 09:39:12,861 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 09:39:12,861 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 09:39:12,861 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 09:39:12,862 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 09:39:12,862 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 60 (enabled: 0) ==========
2025-10-21 09:39:12,862 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 60
2025-10-21 09:39:12,863 - app.services.background_worker - INFO - [HEALTH_SYNC] Completed health check for 4 devices
2025-10-21 09:39:12,863 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 09:39:12,863 - app.services.background_worker - INFO - [BG_WORKER] Background task execution cycle completed
2025-10-21 09:39:13,062 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 09:39:13,063 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 09:39:13,063 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 09:39:13,064 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 09:39:13,065 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 09:39:13,065 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 09:39:13,066 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 09:39:13,427 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5555/Health "HTTP/1.1 200 OK"
2025-10-21 09:39:13,428 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:13,428 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 55, calling start API
2025-10-21 09:39:13,452 - app.services.device_processor - INFO - Sending start data for proxy 55: {'proxyid': '55', 'Controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:13,742 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5555/start "HTTP/1.1 200 OK"
2025-10-21 09:39:13,743 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:13,744 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 55: proxyServiceStart changed to '1'
2025-10-21 09:39:13,744 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 55: {'proxyid': 55, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}}
2025-10-21 09:39:13,744 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:13,745 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 09:39:13,745 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 09:39:13,746 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 09:39:13,746 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 55: network OK
2025-10-21 09:39:13,746 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 55 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 09:39:13,747 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 09:39:13,747 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 55: healthy=True, response_time=0.0
2025-10-21 09:39:13,748 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:13,748 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 09:39:13,749 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 09:39:13,749 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 09:39:13,750 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 56 (enabled: 1) ==========
2025-10-21 09:39:13,751 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 09:39:13,751 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 56 current status: OK
2025-10-21 09:39:13,752 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 56 <<<<<
2025-10-21 09:39:13,752 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 56 (IP: 127.0.0.1:5556)
2025-10-21 09:39:13,753 - app.services.device_processor - INFO - Checking health for proxy 56 at http://127.0.0.1:5556/Health
2025-10-21 09:39:14,076 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5556/Health "HTTP/1.1 200 OK"
2025-10-21 09:39:14,078 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:14,079 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 56, calling start API
2025-10-21 09:39:14,080 - app.services.device_processor - INFO - Sending start data for proxy 56: {'proxyid': '56', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:14,404 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5556/start "HTTP/1.1 200 OK"
2025-10-21 09:39:14,404 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:14,405 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 56: proxyServiceStart changed to '1'
2025-10-21 09:39:14,405 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 56: {'proxyid': 56, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}}
2025-10-21 09:39:14,406 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:14,406 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 09:39:14,406 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 09:39:14,408 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 09:39:14,408 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 56: network OK
2025-10-21 09:39:14,409 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 56 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 09:39:14,409 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 09:39:14,409 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 56: healthy=True, response_time=0.0
2025-10-21 09:39:14,411 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:14,411 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 09:39:14,411 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 09:39:14,412 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 09:39:14,413 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 57 (enabled: 1) ==========
2025-10-21 09:39:14,413 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 09:39:14,414 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 57 current status: Proxy Port not accessible
2025-10-21 09:39:14,414 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 57 <<<<<
2025-10-21 09:39:14,415 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 57 (IP: 127.0.0.1:5557)
2025-10-21 09:39:14,627 - app.services.device_processor - ERROR - [HEALTH_CHECK] Port 5557 on 127.0.0.1 is not accessible for proxy 57
2025-10-21 09:39:14,628 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 57 health check result: proxyServiceStart=0, healthy=False, message=proxy Port not accessible
2025-10-21 09:39:14,629 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 57: healthy=False, response_time=0.0
2025-10-21 09:39:14,629 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 09:39:14,629 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 09:39:14,630 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 09:39:14,630 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 09:39:14,631 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 60 (enabled: 0) ==========
2025-10-21 09:39:14,631 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 60
2025-10-21 09:39:14,631 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 09:39:14,632 - app.services.background_worker - INFO - [HEALTH_SYNC] Completed health check for 4 devices
2025-10-21 09:39:14,632 - app.services.background_worker - INFO - [BG_WORKER] Background task execution cycle completed
2025-10-21 09:39:14,828 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 09:39:14,828 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 09:39:14,828 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 09:39:14,829 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 09:39:14,829 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 09:39:14,830 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 09:39:14,831 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 09:39:15,101 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5555/Health "HTTP/1.1 200 OK"
2025-10-21 09:39:15,101 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:15,103 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 55, calling start API
2025-10-21 09:39:15,125 - app.services.device_processor - INFO - Sending start data for proxy 55: {'proxyid': '55', 'Controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:15,420 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5555/start "HTTP/1.1 200 OK"
2025-10-21 09:39:15,423 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:15,424 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 55: proxyServiceStart changed to '1'
2025-10-21 09:39:15,424 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 55: {'proxyid': 55, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}}
2025-10-21 09:39:15,425 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:15,425 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 09:39:15,426 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 09:39:15,427 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 09:39:15,427 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 55: network OK
2025-10-21 09:39:15,428 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 55 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 09:39:15,428 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 09:39:15,428 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 55: healthy=True, response_time=0.0
2025-10-21 09:39:15,429 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:15,430 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 09:39:15,431 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 09:39:15,431 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 09:39:15,431 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 56 (enabled: 1) ==========
2025-10-21 09:39:15,432 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 09:39:15,432 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 56 current status: OK
2025-10-21 09:39:15,433 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 56 <<<<<
2025-10-21 09:39:15,433 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 56 (IP: 127.0.0.1:5556)
2025-10-21 09:39:15,434 - app.services.device_processor - INFO - Checking health for proxy 56 at http://127.0.0.1:5556/Health
2025-10-21 09:39:15,718 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5556/Health "HTTP/1.1 200 OK"
2025-10-21 09:39:15,719 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:15,719 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 56, calling start API
2025-10-21 09:39:15,720 - app.services.device_processor - INFO - Sending start data for proxy 56: {'proxyid': '56', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:16,006 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5556/start "HTTP/1.1 200 OK"
2025-10-21 09:39:16,007 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:16,007 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 56: proxyServiceStart changed to '1'
2025-10-21 09:39:16,008 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 56: {'proxyid': 56, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}}
2025-10-21 09:39:16,008 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:16,009 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 09:39:16,009 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 09:39:16,010 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 09:39:16,010 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 56: network OK
2025-10-21 09:39:16,011 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 09:39:16,011 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 56 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 09:39:16,012 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 56: healthy=True, response_time=0.0
2025-10-21 09:39:16,013 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:16,014 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 09:39:16,014 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 09:39:16,015 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 09:39:16,015 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 57 (enabled: 1) ==========
2025-10-21 09:39:16,015 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 09:39:16,016 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 57 current status: Proxy Port not accessible
2025-10-21 09:39:16,016 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 57 <<<<<
2025-10-21 09:39:16,017 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 57 (IP: 127.0.0.1:5557)
2025-10-21 09:39:16,229 - app.services.device_processor - ERROR - [HEALTH_CHECK] Port 5557 on 127.0.0.1 is not accessible for proxy 57
2025-10-21 09:39:16,229 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 57 health check result: proxyServiceStart=0, healthy=False, message=proxy Port not accessible
2025-10-21 09:39:16,229 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 57: healthy=False, response_time=0.0
2025-10-21 09:39:16,229 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 09:39:16,230 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 09:39:16,230 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 09:39:16,231 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 09:39:16,232 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 60 (enabled: 0) ==========
2025-10-21 09:39:16,232 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 60
2025-10-21 09:39:16,232 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 09:39:16,232 - app.services.background_worker - INFO - [HEALTH_SYNC] Completed health check for 4 devices
2025-10-21 09:39:16,233 - app.services.background_worker - INFO - [BG_WORKER] Background task execution cycle completed
2025-10-21 09:39:16,433 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 09:39:16,434 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 09:39:16,434 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 09:39:16,435 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 09:39:16,435 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 09:39:16,435 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 09:39:16,436 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 09:39:16,684 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5555/Health "HTTP/1.1 200 OK"
2025-10-21 09:39:16,685 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:16,685 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 55, calling start API
2025-10-21 09:39:16,698 - app.services.device_processor - INFO - Sending start data for proxy 55: {'proxyid': '55', 'Controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:16,949 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5555/start "HTTP/1.1 200 OK"
2025-10-21 09:39:16,950 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:16,951 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 55: proxyServiceStart changed to '1'
2025-10-21 09:39:16,951 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 55: {'proxyid': 55, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}}
2025-10-21 09:39:16,952 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:16,952 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 09:39:16,952 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 09:39:16,954 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 09:39:16,954 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 55: network OK
2025-10-21 09:39:16,955 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 09:39:16,955 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 55 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 09:39:16,956 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 55: healthy=True, response_time=0.0
2025-10-21 09:39:16,956 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:16,957 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 09:39:16,957 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 09:39:16,957 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 09:39:16,958 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 56 (enabled: 1) ==========
2025-10-21 09:39:16,959 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 09:39:16,959 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 56 current status: OK
2025-10-21 09:39:16,960 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 56 <<<<<
2025-10-21 09:39:16,960 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 56 (IP: 127.0.0.1:5556)
2025-10-21 09:39:16,961 - app.services.device_processor - INFO - Checking health for proxy 56 at http://127.0.0.1:5556/Health
2025-10-21 09:39:17,226 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5556/Health "HTTP/1.1 200 OK"
2025-10-21 09:39:17,227 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:17,227 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 56, calling start API
2025-10-21 09:39:17,227 - app.services.device_processor - INFO - Sending start data for proxy 56: {'proxyid': '56', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:17,496 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5556/start "HTTP/1.1 200 OK"
2025-10-21 09:39:17,497 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:17,497 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 56: proxyServiceStart changed to '1'
2025-10-21 09:39:17,498 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 56: {'proxyid': 56, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}}
2025-10-21 09:39:17,499 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:17,499 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 09:39:17,499 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 09:39:17,500 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 09:39:17,500 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 56: network OK
2025-10-21 09:39:17,501 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 56 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 09:39:17,501 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 09:39:17,502 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 56: healthy=True, response_time=0.0
2025-10-21 09:39:17,503 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:17,503 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 09:39:17,503 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 09:39:17,504 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 09:39:17,505 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 57 (enabled: 1) ==========
2025-10-21 09:39:17,505 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 57 current status: Proxy Port not accessible
2025-10-21 09:39:17,505 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 09:39:17,505 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 57 <<<<<
2025-10-21 09:39:17,506 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 57 (IP: 127.0.0.1:5557)
2025-10-21 09:39:17,721 - app.services.device_processor - ERROR - [HEALTH_CHECK] Port 5557 on 127.0.0.1 is not accessible for proxy 57
2025-10-21 09:39:17,722 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 57 health check result: proxyServiceStart=0, healthy=False, message=proxy Port not accessible
2025-10-21 09:39:17,722 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 57: healthy=False, response_time=0.0
2025-10-21 09:39:17,723 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 09:39:17,724 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 09:39:17,724 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 09:39:17,724 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 09:39:17,725 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 60 (enabled: 0) ==========
2025-10-21 09:39:17,725 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 60
2025-10-21 09:39:17,726 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 09:39:17,726 - app.services.background_worker - INFO - [HEALTH_SYNC] Completed health check for 4 devices
2025-10-21 09:39:17,726 - app.services.background_worker - INFO - [BG_WORKER] Background task execution cycle completed
2025-10-21 09:39:17,922 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 09:39:17,923 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 09:39:17,923 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 09:39:17,924 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 09:39:17,925 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 09:39:17,925 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 09:39:17,926 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 09:39:18,207 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5555/Health "HTTP/1.1 200 OK"
2025-10-21 09:39:18,207 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:18,208 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 55, calling start API
2025-10-21 09:39:18,208 - app.services.device_processor - INFO - Sending start data for proxy 55: {'proxyid': '55', 'Controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:18,460 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5555/start "HTTP/1.1 200 OK"
2025-10-21 09:39:18,464 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:18,465 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 55: proxyServiceStart changed to '1'
2025-10-21 09:39:18,465 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 55: {'proxyid': 55, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}}
2025-10-21 09:39:18,465 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:18,467 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 09:39:18,467 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 09:39:18,467 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 09:39:18,467 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 55: network OK
2025-10-21 09:39:18,468 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 55 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 09:39:18,469 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 09:39:18,469 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 55: healthy=True, response_time=0.0
2025-10-21 09:39:18,471 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:18,471 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 09:39:18,471 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 09:39:18,472 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 09:39:18,472 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 56 (enabled: 1) ==========
2025-10-21 09:39:18,473 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 56 current status: OK
2025-10-21 09:39:18,473 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 09:39:18,473 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 56 <<<<<
2025-10-21 09:39:18,474 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 56 (IP: 127.0.0.1:5556)
2025-10-21 09:39:18,499 - app.services.device_processor - INFO - Checking health for proxy 56 at http://127.0.0.1:5556/Health
2025-10-21 09:39:18,763 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5556/Health "HTTP/1.1 200 OK"
2025-10-21 09:39:18,764 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:18,764 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 56, calling start API
2025-10-21 09:39:18,765 - app.services.device_processor - INFO - Sending start data for proxy 56: {'proxyid': '56', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:19,030 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5556/start "HTTP/1.1 200 OK"
2025-10-21 09:39:19,030 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:19,031 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 56: proxyServiceStart changed to '1'
2025-10-21 09:39:19,031 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 56: {'proxyid': 56, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}}
2025-10-21 09:39:19,032 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:19,032 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 09:39:19,033 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 09:39:19,033 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 09:39:19,034 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 56: network OK
2025-10-21 09:39:19,035 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 56 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 09:39:19,035 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 09:39:19,035 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 56: healthy=True, response_time=0.0
2025-10-21 09:39:19,036 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:19,037 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 09:39:19,037 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 09:39:19,038 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 09:39:19,038 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 57 (enabled: 1) ==========
2025-10-21 09:39:19,038 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 09:39:19,039 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 57 current status: Proxy Port not accessible
2025-10-21 09:39:19,039 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 57 <<<<<
2025-10-21 09:39:19,040 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 57 (IP: 127.0.0.1:5557)
2025-10-21 09:39:19,244 - app.services.device_processor - ERROR - [HEALTH_CHECK] Port 5557 on 127.0.0.1 is not accessible for proxy 57
2025-10-21 09:39:19,245 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 57 health check result: proxyServiceStart=0, healthy=False, message=proxy Port not accessible
2025-10-21 09:39:19,246 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 57: healthy=False, response_time=0.0
2025-10-21 09:39:19,246 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 09:39:19,247 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 09:39:19,248 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 09:39:19,248 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 09:39:19,249 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 60 (enabled: 0) ==========
2025-10-21 09:39:19,249 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 09:39:19,249 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 60
2025-10-21 09:39:19,250 - app.services.background_worker - INFO - [HEALTH_SYNC] Completed health check for 4 devices
2025-10-21 09:39:19,250 - app.services.background_worker - INFO - [BG_WORKER] Background task execution cycle completed
2025-10-21 09:39:19,448 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 09:39:19,448 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 09:39:19,449 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 09:39:19,449 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 09:39:19,449 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 09:39:19,449 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 09:39:19,464 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 09:39:19,707 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5555/Health "HTTP/1.1 200 OK"
2025-10-21 09:39:19,707 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:19,708 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 55, calling start API
2025-10-21 09:39:19,727 - app.services.device_processor - INFO - Sending start data for proxy 55: {'proxyid': '55', 'Controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:20,000 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5555/start "HTTP/1.1 200 OK"
2025-10-21 09:39:20,001 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:20,001 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 55: proxyServiceStart changed to '1'
2025-10-21 09:39:20,002 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 55: {'proxyid': 55, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}}
2025-10-21 09:39:20,002 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:20,002 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 09:39:20,003 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 09:39:20,004 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 09:39:20,004 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 55: network OK
2025-10-21 09:39:20,005 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 55 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 09:39:20,005 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 09:39:20,005 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 55: healthy=True, response_time=0.0
2025-10-21 09:39:20,006 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:20,007 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 09:39:20,007 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 09:39:20,008 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 09:39:20,008 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 56 (enabled: 1) ==========
2025-10-21 09:39:20,009 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 09:39:20,009 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 56 current status: OK
2025-10-21 09:39:20,009 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 56 <<<<<
2025-10-21 09:39:20,010 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 56 (IP: 127.0.0.1:5556)
2025-10-21 09:39:20,011 - app.services.device_processor - INFO - Checking health for proxy 56 at http://127.0.0.1:5556/Health
2025-10-21 09:39:20,300 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5556/Health "HTTP/1.1 200 OK"
2025-10-21 09:39:20,301 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:20,301 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 56, calling start API
2025-10-21 09:39:20,303 - app.services.device_processor - INFO - Sending start data for proxy 56: {'proxyid': '56', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:20,617 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5556/start "HTTP/1.1 200 OK"
2025-10-21 09:39:20,618 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:20,619 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 56: proxyServiceStart changed to '1'
2025-10-21 09:39:20,619 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 56: {'proxyid': 56, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}}
2025-10-21 09:39:20,620 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:20,620 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 09:39:20,620 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 09:39:20,621 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 09:39:20,621 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 56: network OK
2025-10-21 09:39:20,622 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 56 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 09:39:20,622 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 09:39:20,622 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 56: healthy=True, response_time=0.0
2025-10-21 09:39:20,623 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:20,624 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 09:39:20,624 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 09:39:20,625 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 09:39:20,625 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 57 (enabled: 1) ==========
2025-10-21 09:39:20,626 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 57 current status: Proxy Port not accessible
2025-10-21 09:39:20,626 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 09:39:20,626 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 57 <<<<<
2025-10-21 09:39:20,627 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 57 (IP: 127.0.0.1:5557)
2025-10-21 09:39:20,832 - app.services.device_processor - ERROR - [HEALTH_CHECK] Port 5557 on 127.0.0.1 is not accessible for proxy 57
2025-10-21 09:39:20,833 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 57 health check result: proxyServiceStart=0, healthy=False, message=proxy Port not accessible
2025-10-21 09:39:20,833 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 57: healthy=False, response_time=0.0
2025-10-21 09:39:20,833 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 09:39:20,834 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 09:39:20,834 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 09:39:20,834 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 09:39:20,835 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 60 (enabled: 0) ==========
2025-10-21 09:39:20,835 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 60
2025-10-21 09:39:20,836 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 09:39:20,836 - app.services.background_worker - INFO - [HEALTH_SYNC] Completed health check for 4 devices
2025-10-21 09:39:20,836 - app.services.background_worker - INFO - [BG_WORKER] Background task execution cycle completed
2025-10-21 09:39:21,033 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 09:39:21,034 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 09:39:21,034 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 09:39:21,035 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 09:39:21,035 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 09:39:21,036 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 09:39:21,037 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 09:39:21,310 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5555/Health "HTTP/1.1 200 OK"
2025-10-21 09:39:21,311 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:21,311 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 55, calling start API
2025-10-21 09:39:21,330 - app.services.device_processor - INFO - Sending start data for proxy 55: {'proxyid': '55', 'Controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:21,610 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5555/start "HTTP/1.1 200 OK"
2025-10-21 09:39:21,610 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:21,611 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 55: proxyServiceStart changed to '1'
2025-10-21 09:39:21,612 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 55: {'proxyid': 55, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}}
2025-10-21 09:39:21,612 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:21,613 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 09:39:21,613 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 09:39:21,614 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 09:39:21,615 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 55: network OK
2025-10-21 09:39:21,615 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 09:39:21,615 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 55 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 09:39:21,616 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 55: healthy=True, response_time=0.0
2025-10-21 09:39:21,616 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:21,617 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 09:39:21,617 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 09:39:21,618 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 09:39:21,618 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 56 (enabled: 1) ==========
2025-10-21 09:39:21,619 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 56 current status: OK
2025-10-21 09:39:21,619 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 09:39:21,620 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 56 <<<<<
2025-10-21 09:39:21,620 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 56 (IP: 127.0.0.1:5556)
2025-10-21 09:39:21,621 - app.services.device_processor - INFO - Checking health for proxy 56 at http://127.0.0.1:5556/Health
2025-10-21 09:39:21,904 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5556/Health "HTTP/1.1 200 OK"
2025-10-21 09:39:21,905 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:21,905 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 56, calling start API
2025-10-21 09:39:21,918 - app.services.device_processor - INFO - Sending start data for proxy 56: {'proxyid': '56', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:22,197 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5556/start "HTTP/1.1 200 OK"
2025-10-21 09:39:22,198 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:22,199 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 56: proxyServiceStart changed to '1'
2025-10-21 09:39:22,199 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 56: {'proxyid': 56, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}}
2025-10-21 09:39:22,200 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:22,200 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 09:39:22,201 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 09:39:22,201 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 09:39:22,201 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 56: network OK
2025-10-21 09:39:22,202 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 09:39:22,202 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 56 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 09:39:22,202 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 56: healthy=True, response_time=0.0
2025-10-21 09:39:22,203 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:22,203 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 09:39:22,204 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 09:39:22,205 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 09:39:22,205 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 57 (enabled: 1) ==========
2025-10-21 09:39:22,206 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 09:39:22,206 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 57 current status: Proxy Port not accessible
2025-10-21 09:39:22,207 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 57 <<<<<
2025-10-21 09:39:22,207 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 57 (IP: 127.0.0.1:5557)
2025-10-21 09:39:22,416 - app.services.device_processor - ERROR - [HEALTH_CHECK] Port 5557 on 127.0.0.1 is not accessible for proxy 57
2025-10-21 09:39:22,416 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 57 health check result: proxyServiceStart=0, healthy=False, message=proxy Port not accessible
2025-10-21 09:39:22,416 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 57: healthy=False, response_time=0.0
2025-10-21 09:39:22,417 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 09:39:22,417 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 09:39:22,417 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 09:39:22,418 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 09:39:22,419 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 60 (enabled: 0) ==========
2025-10-21 09:39:22,419 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 60
2025-10-21 09:39:22,420 - app.services.background_worker - INFO - [HEALTH_SYNC] Completed health check for 4 devices
2025-10-21 09:39:22,420 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 09:39:22,420 - app.services.background_worker - INFO - [BG_WORKER] Background task execution cycle completed
2025-10-21 09:39:22,634 - app.services.background_worker - INFO - [BG_WORKER] Starting background task execution cycle
2025-10-21 09:39:22,635 - app.services.background_worker - INFO - [HEALTH_SYNC] Starting synchronous health check for all proxy services
2025-10-21 09:39:22,635 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 55 (enabled: 1) ==========
2025-10-21 09:39:22,636 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 55 current status: OK
2025-10-21 09:39:22,636 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 55 <<<<<
2025-10-21 09:39:22,636 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 55 (IP: 127.0.0.1:5555)
2025-10-21 09:39:22,638 - app.services.device_processor - INFO - Checking health for proxy 55 at http://127.0.0.1:5555/Health
2025-10-21 09:39:22,950 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5555/Health "HTTP/1.1 200 OK"
2025-10-21 09:39:22,952 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:22,953 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 55, calling start API
2025-10-21 09:39:22,953 - app.services.device_processor - INFO - Sending start data for proxy 55: {'proxyid': '55', 'Controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:23,239 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5555/start "HTTP/1.1 200 OK"
2025-10-21 09:39:23,240 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 55: {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:23,240 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 55: proxyServiceStart changed to '1'
2025-10-21 09:39:23,241 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 55: {'proxyid': 55, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 55, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}}
2025-10-21 09:39:23,241 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:23,242 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 09:39:23,242 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 09:39:23,243 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 09:39:23,243 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 55: network OK
2025-10-21 09:39:23,244 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 09:39:23,245 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 55 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 09:39:23,245 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 55: healthy=True, response_time=0.0
2025-10-21 09:39:23,246 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/55, Payload: {'message': 'OK', 'proxyid': 55, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E82', 'proxy_ip': '127.0.0.1', 'proxy_port': '5555', 'remark': 'tsc11'}
2025-10-21 09:39:23,246 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/55, QoS: 0, Payload: {"message": "OK", "proxyid": 55, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E82", "proxy_ip": "127.0.0.1", "proxy_port": "5555", "remark": "tsc11"}
2025-10-21 09:39:23,247 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/55 - 結果碼: 0
2025-10-21 09:39:23,247 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/55
2025-10-21 09:39:23,248 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 56 (enabled: 1) ==========
2025-10-21 09:39:23,248 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/55, 內容長度: 197 bytes
2025-10-21 09:39:23,248 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 56 current status: OK
2025-10-21 09:39:23,249 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 56 <<<<<
2025-10-21 09:39:23,249 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 56 (IP: 127.0.0.1:5556)
2025-10-21 09:39:23,250 - app.services.device_processor - INFO - Checking health for proxy 56 at http://127.0.0.1:5556/Health
2025-10-21 09:39:23,517 - httpx - INFO - HTTP Request: GET http://127.0.0.1:5556/Health "HTTP/1.1 200 OK"
2025-10-21 09:39:23,517 - app.services.device_processor - INFO - [HEALTH_CHECK] Health check response for proxy 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:23,517 - app.services.device_processor - INFO - [HEALTH_CHECK] Network communication OK for device 56, calling start API
2025-10-21 09:39:23,518 - app.services.device_processor - INFO - Sending start data for proxy 56: {'proxyid': '56', 'Controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:23,777 - httpx - INFO - HTTP Request: POST http://127.0.0.1:5556/start "HTTP/1.1 200 OK"
2025-10-21 09:39:23,778 - app.services.device_processor - INFO - [START_PROXY] Successfully started proxy service 56: {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:23,778 - app.services.device_processor - INFO - [START_PROXY] Updated device status cache for proxy 56: proxyServiceStart changed to '1'
2025-10-21 09:39:23,779 - app.services.device_processor - INFO - [HEALTH_CHECK] Start API result for device 56: {'proxyid': 56, 'status': 'success', 'message': 'OK', 'result': {'message': 'OK', 'proxyid': 56, 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}}
2025-10-21 09:39:23,779 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'healthy', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:23,779 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "healthy", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 09:39:23,780 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 09:39:23,781 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 09:39:23,781 - app.services.device_processor - INFO - [HEALTH_CHECK] Published MQTT message for device 56: network OK
2025-10-21 09:39:23,782 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 56 health check result: proxyServiceStart=1, healthy=True, message=OK
2025-10-21 09:39:23,782 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 09:39:23,782 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 56: healthy=True, response_time=0.0
2025-10-21 09:39:23,783 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/56, Payload: {'message': 'OK', 'proxyid': 56, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5556', 'remark': 'Stk1'}
2025-10-21 09:39:23,783 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/56, QoS: 0, Payload: {"message": "OK", "proxyid": 56, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5556", "remark": "Stk1"}
2025-10-21 09:39:23,784 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/56 - 結果碼: 0
2025-10-21 09:39:23,785 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/56
2025-10-21 09:39:23,785 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 57 (enabled: 1) ==========
2025-10-21 09:39:23,785 - app.services.background_worker - INFO - [HEALTH_SYNC] Device 57 current status: Proxy Port not accessible
2025-10-21 09:39:23,786 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/56, 內容長度: 196 bytes
2025-10-21 09:39:23,786 - app.services.background_worker - INFO - [HEALTH_SYNC] >>>>> Health checking enabled device 57 <<<<<
2025-10-21 09:39:23,787 - app.services.device_processor - INFO - [HEALTH_CHECK] Starting health check for proxy 57 (IP: 127.0.0.1:5557)
2025-10-21 09:39:23,998 - app.services.device_processor - ERROR - [HEALTH_CHECK] Port 5557 on 127.0.0.1 is not accessible for proxy 57
2025-10-21 09:39:23,999 - app.services.background_worker - INFO - [HEALTH_SYNC] Proxy 57 health check result: proxyServiceStart=0, healthy=False, message=proxy Port not accessible
2025-10-21 09:39:23,999 - app.services.background_worker - INFO - [DEBUG] Would publish health check result for proxy 57: healthy=False, response_time=0.0
2025-10-21 09:39:23,999 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Publishing proxy status update - Topic: mcs/events/ProxyService/status/57, Payload: {'message': 'OK', 'proxyid': 57, 'status': 'running', 'proxyServiceAlive': '1', 'proxyServiceStart': '1', 'controller_type': 'E88', 'proxy_ip': '127.0.0.1', 'proxy_port': '5557', 'remark': 'Stk2'}
2025-10-21 09:39:24,000 - app.mqtt.client - INFO - [MQTT_CLIENT] Publishing message - Topic: mcs/events/ProxyService/status/57, QoS: 0, Payload: {"message": "OK", "proxyid": 57, "status": "running", "proxyServiceAlive": "1", "proxyServiceStart": "1", "controller_type": "E88", "proxy_ip": "127.0.0.1", "proxy_port": "5557", "remark": "Stk2"}
2025-10-21 09:39:24,000 - app.mqtt.client - INFO - [MQTT_CLIENT] 成功發佈訊息到主題 mcs/events/ProxyService/status/57 - 結果碼: 0
2025-10-21 09:39:24,001 - app.mqtt.publisher - INFO - [MQTT_PUBLISH] Successfully published to topic: mcs/events/ProxyService/status/57
2025-10-21 09:39:24,001 - app.services.background_worker - INFO - [HEALTH_SYNC] ========== Processing device 60 (enabled: 0) ==========
2025-10-21 09:39:24,001 - app.services.background_worker - WARNING - [HEALTH_SYNC] No status cache for device 60
2025-10-21 09:39:24,002 - app.mqtt.client - INFO - [MQTT_CLIENT] 收到MQTT訊息 - 主題: mcs/events/ProxyService/status/57, 內容長度: 196 bytes
2025-10-21 09:39:24,002 - app.services.background_worker - INFO - [HEALTH_SYNC] Completed health check for 4 devices
2025-10-21 09:39:24,003 - app.services.background_worker - INFO - [BG_WORKER] Background task execution cycle completed
2025-10-21 09:39:24,004 - app.services.background_worker - INFO - Background worker task cancelled
